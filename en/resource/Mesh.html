
<!DOCTYPE HTML>
<html lang="en" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Bluetooth Mesh(TUYA) Â· GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="../../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-prism/prism-okaidia.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-anchors/plugin.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-splitter/splitter.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-anchor-navigation-ex/style/plugin.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-expandable-chapters-small/expandable-chapters-small.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-pageview-count/plugin.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-language-picker/plugin.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-flexible-alerts/style.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="Mesh.html" />
    
    
    <link rel="prev" href="SIGMesh.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    Features Overview
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="Preparation.html">
            
                <a href="Preparation.html">
            
                    
                    Preparation for Integration
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="Integrated.html">
            
                <a href="Integrated.html">
            
                    
                    Integrate SDK
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="Demo.html">
            
                <a href="Demo.html">
            
                    
                    Demo App
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="iOSAdaptation.html">
            
                <a href="iOSAdaptation.html">
            
                    
                    iOS Adaptation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6" data-path="User.html">
            
                <a href="User.html#user-management">
            
                    
                    User Management
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.1" data-path="User.html">
            
                <a href="User.html#use-mobile-phone-for-login">
            
                    
                    Use Mobile Phone for Login
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.2" data-path="User.html">
            
                <a href="User.html#use-email-for-login">
            
                    
                    Use Email for Login
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.3" data-path="User.html">
            
                <a href="User.html#use-uid-for-login">
            
                    
                    Use UID for Login
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.4" data-path="User.html">
            
                <a href="User.html#third-party-login">
            
                    
                    Third Party Login
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.5" data-path="User.html">
            
                <a href="User.html#login-by-auth2">
            
                    
                    Login by Auth2
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.6" data-path="User.html">
            
                <a href="User.html#anonymous-registration">
            
                    
                    Anonymous registration
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.7" data-path="User.html">
            
                <a href="User.html#modify-user-info">
            
                    
                    Modify User Info
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.8" data-path="User.html">
            
                <a href="User.html#logout-disable-account">
            
                    
                    Logout, Disable Account
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.9" data-path="User.html">
            
                <a href="User.html#user-data-model">
            
                    
                    User Data Model
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.10" data-path="User.html">
            
                <a href="User.html#handling-of-expired-session">
            
                    
                    Handling of Expired Session
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.7" data-path="HomeAbout.html">
            
                <a href="HomeAbout.html">
            
                    
                    Home Management
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.7.1" data-path="Home.html">
            
                <a href="Home.html#home-relationship-management">
            
                    
                    Home Relationship Management
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.2" data-path="Home.html">
            
                <a href="Home.html#home-information-management">
            
                    
                    Operation of Home
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.3" data-path="Home.html">
            
                <a href="Home.html#member-management">
            
                    
                    Home Member Management
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.4" data-path="Home.html">
            
                <a href="Home.html#room-information-management">
            
                    
                    Room Management
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.5" data-path="Home.html">
            
                <a href="Home.html#home-weather">
            
                    
                    Home's Weather
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.8" data-path="Activator.html">
            
                <a href="Activator.html#device-configuration">
            
                    
                    Device Configuration
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.8.1" data-path="Activator.html">
            
                <a href="Activator.html#functional-overview">
            
                    
                    Functional Overview
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.2" data-path="Activator.html">
            
                <a href="Activator.html#instructions">
            
                    
                    Instructions
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.3" data-path="Activator.html">
            
                <a href="Activator.html#Implementation">
            
                    
                    Implementation
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.8.3.1" data-path="Activator.html">
            
                <a href="Activator.html#quick-connection-mode">
            
                    
                    Quick Connection Mode
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.3.2" data-path="Activator.html">
            
                <a href="Activator.html#hotspot-mode">
            
                    
                    HotSpot Mode
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.3.3" data-path="Activator.html">
            
                <a href="Activator.html#camera-scan-code-network-configuration">
            
                    
                    Camera Scan Code Network Configuration
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.3.4" data-path="Activator.html">
            
                <a href="Activator.html#wired-network-configuration">
            
                    
                    Wired Network Configuration
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.3.5" data-path="Activator.html">
            
                <a href="Activator.html#sub-device-configuration">
            
                    
                    Sub-Device Configuration
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.3.6" data-path="Activator.html">
            
                <a href="Activator.html#bluetooth-configuration">
            
                    
                    Bluetooth Configuration
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.9" data-path="Device.html">
            
                <a href="Device.html#device-management">
            
                    
                    Device Management
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.9.1" data-path="Device.html">
            
                <a href="Device.html#initialize-device">
            
                    
                    Initialize Device
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.2" data-path="Device.html">
            
                <a href="Device.html#delegate-of-device">
            
                    
                    Delegate of Device
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.3" data-path="Device.html">
            
                <a href="Device.html#device-control">
            
                    
                    Device Control
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.4" data-path="Device.html">
            
                <a href="Device.html#functions-of-device">
            
                    
                    Functions of Device
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.5" data-path="Device.html">
            
                <a href="Device.html#querying-device-information">
            
                    
                    Querying Device Information
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.6" data-path="Device.html">
            
                <a href="Device.html#modify-the-device-name">
            
                    
                    Modify the Device Name
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.7" data-path="Device.html">
            
                <a href="Device.html#remove-device">
            
                    
                    Remove Device
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.8" data-path="Device.html">
            
                <a href="Device.html#restore-factory-settings">
            
                    
                    Restore Factory Settings
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.9" data-path="Device.html">
            
                <a href="Device.html#obtain-wi-fi-signal-strength">
            
                    
                    Obtain Wi-Fi Signal Strength
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.10" data-path="Device.html">
            
                <a href="Device.html#obtain-the-sub-device-list-of-a-gateway">
            
                    
                    Obtain the Sub-Device List of a Gateway
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.11" data-path="Device.html">
            
                <a href="Device.html#firmware-upgrade">
            
                    
                    Firmware Upgrade
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.12" data-path="Device.html">
            
                <a href="Device.html#fetch-the-log-of-dp-report">
            
                    
                    Fetch the Log of DP Report
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.10" data-path="MultiControl.html">
            
                <a href="MultiControl.html#device-multi-control">
            
                    
                    Device Multi-Control
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.10.1" data-path="MultiControl.html">
            
                <a href="MultiControl.html#overview">
            
                    
                    Overview
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.2" data-path="MultiControl.html">
            
                <a href="MultiControl.html#bussiness-flowchart">
            
                    
                    Bussiness Flowchart
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.3" data-path="MultiControl.html">
            
                <a href="MultiControl.html#get-device-dp-information">
            
                    
                    Get Device Dp Information
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.4" data-path="MultiControl.html">
            
                <a href="MultiControl.html#query-related-information-of-a-dp">
            
                    
                    Query Related Information of a Dp
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.5" data-path="MultiControl.html">
            
                <a href="MultiControl.html#add-multi-control-group">
            
                    
                    Add Multi-control Group
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.6" data-path="MultiControl.html">
            
                <a href="MultiControl.html#update-multi-control-group">
            
                    
                    Update Multi-control Group
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.7" data-path="MultiControl.html">
            
                <a href="MultiControl.html#enable-or-disable-multi-control-group">
            
                    
                    Enable or Disable Multi-control Group
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.8" data-path="MultiControl.html">
            
                <a href="MultiControl.html#query-devices-that-support-multi-control">
            
                    
                    Query Devices that Support Multi-control
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.9" data-path="MultiControl.html">
            
                <a href="MultiControl.html#get-affiliate-device-details">
            
                    
                    Get Affiliate Device Details
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.11" data-path="Share.html">
            
                <a href="Share.html#shared-devices">
            
                    
                    Share Devices
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.11.1" data-path="Share.html">
            
                <a href="Share.html#add-device-share">
            
                    
                    Add Device Share
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.2" data-path="Share.html">
            
                <a href="Share.html#getting-shared-relationships">
            
                    
                    Getting Shared Relationships
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.3" data-path="Share.html">
            
                <a href="Share.html#remove-sharing">
            
                    
                    Remove Sharing
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.4" data-path="Share.html">
            
                <a href="Share.html#modify-note-name">
            
                    
                    Modify Note Name
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.12" data-path="Timer.html">
            
                <a href="Timer.html">
            
                    
                    Timer Task
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.13" data-path="Group.html">
            
                <a href="Group.html#group-management">
            
                    
                    Group Management
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.13.1" data-path="Group.html">
            
                <a href="Group.html#functional-overview">
            
                    
                    Functional Overview
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.13.2" data-path="Group.html">
            
                <a href="Group.html#create-group">
            
                    
                    Create Group
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.13.2.1" data-path="Group.html">
            
                <a href="Group.html#create-wi-fi-group">
            
                    
                    Create Wi-Fi Group
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.13.2.2" data-path="Group.html">
            
                <a href="Group.html#create-zigbee-group">
            
                    
                    Create ZigBee Group
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.13.3" data-path="Group.html">
            
                <a href="Group.html#group-operation">
            
                    
                    Group Operation
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.13.3.1" data-path="Group.html">
            
                <a href="Group.html#instantiation">
            
                    
                    Instantiation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.13.3.2" data-path="Group.html">
            
                <a href="Group.html#modifying-group-name">
            
                    
                    Modifying group name
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.13.3.3" data-path="Group.html">
            
                <a href="Group.html#dismiss-group">
            
                    
                    Dismiss Group
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.13.3.4" data-path="Group.html">
            
                <a href="Group.html#sending-group-control-command">
            
                    
                    Sending group control command
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.13.3.5" data-path="Group.html">
            
                <a href="Group.html#group-callback-event">
            
                    
                    Group callback event
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.13.3.6" data-path="Group.html">
            
                <a href="Group.html#group-data-acquisition">
            
                    
                    Group data acquisition
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.14" data-path="SmartScene.html">
            
                <a href="SmartScene.html#smart-scene">
            
                    
                    Smart Scene
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.14.1" data-path="SmartScene.html">
            
                <a href="SmartScene.html#scene-condition">
            
                    
                    Scene Condition
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.14.2" data-path="SmartScene.html">
            
                <a href="SmartScene.html#scene-action">
            
                    
                    Scene Action
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.14.3" data-path="SmartScene.html">
            
                <a href="SmartScene.html#smart-scene-management">
            
                    
                    Smart Scene Management
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.14.4" data-path="SmartScene.html">
            
                <a href="SmartScene.html#scene-operation">
            
                    
                    Scene Operation
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.15" data-path="Message.html">
            
                <a href="Message.html#message-center">
            
                    
                    Message Center
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.15.1" data-path="Message.html">
            
                <a href="Message.html#message">
            
                    
                    Message
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.15.2" data-path="Message.html">
            
                <a href="Message.html#push-notification">
            
                    
                    Push Notification
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.16" data-path="Feedback.html">
            
                <a href="Feedback.html#feedback">
            
                    
                    Feedback
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.16.1" data-path="Feedback.html">
            
                <a href="Feedback.html#obtain-feedback-talk-list">
            
                    
                    Obtain Feedback Talk List
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.16.2" data-path="Feedback.html">
            
                <a href="Feedback.html#obtain-feedback-list">
            
                    
                    Obtain Feedback List
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.16.3" data-path="Feedback.html">
            
                <a href="Feedback.html#obtain-feedback-type-list">
            
                    
                    Obtain Feedback Type List
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.16.4" data-path="Feedback.html">
            
                <a href="Feedback.html#add-feedback">
            
                    
                    Add Feedback
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.17" data-path="Push.html">
            
                <a href="Push.html">
            
                    
                    Integrate Push
            
                </a>
            

            
        </li>
    

    
        
        <li class="divider"></li>
        
        
    
        <li class="chapter " data-level="2.1" data-path="BLE.html">
            
                <a href="BLE.html">
            
                    
                    TUYA BLE
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.1.1" data-path="BLE.html">
            
                <a href="BLE.html#bluetooth-low-energy">
            
                    
                    Bluetooth Low Energy
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.1.1.1" data-path="BLE.html">
            
                <a href="BLE.html#preparatory-work">
            
                    
                    Preparatory Work
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.1.2" data-path="BLE.html">
            
                <a href="BLE.html#scanning-device">
            
                    
                    Scanning Device
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.1.3" data-path="BLE.html">
            
                <a href="BLE.html#ble-device-activation">
            
                    
                    BLE Device Activation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.1.4" data-path="BLE.html">
            
                <a href="BLE.html#dual-mode-device-activation">
            
                    
                    Dual-mode Device Activation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.1.5" data-path="BLE.html">
            
                <a href="BLE.html#ble-device-function">
            
                    
                    BLE Device Function
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.1.6" data-path="BLE.html">
            
                <a href="BLE.html#ble-ota">
            
                    
                    BLE OTA
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.1.7" data-path="BLE.html">
            
                <a href="BLE.html#error-code">
            
                    
                    Error Code
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.1.2" data-path="SIGMesh.html">
            
                <a href="SIGMesh.html#bluetooth-meshsig">
            
                    
                    Bluetooth Mesh(SIG)
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.1.2.1" data-path="SIGMesh.html">
            
                <a href="SIGMesh.html#prepare">
            
                    
                    Prepare
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.2.2" data-path="SIGMesh.html">
            
                <a href="SIGMesh.html#basic-notion">
            
                    
                    Basic Notion
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.2.3" data-path="SIGMesh.html">
            
                <a href="SIGMesh.html#management">
            
                    
                    Management
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.2.4" data-path="SIGMesh.html">
            
                <a href="SIGMesh.html#activation">
            
                    
                    Activation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.2.5" data-path="SIGMesh.html">
            
                <a href="SIGMesh.html#device">
            
                    
                    Device
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.2.6" data-path="SIGMesh.html">
            
                <a href="SIGMesh.html#group">
            
                    
                    Group
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.2.7" data-path="SIGMesh.html">
            
                <a href="SIGMesh.html#control">
            
                    
                    Control
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.2.8" data-path="SIGMesh.html">
            
                <a href="SIGMesh.html#firmware-upgrade">
            
                    
                    Firmware Upgrade
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.1.3" data-path="Mesh.html">
            
                <a href="Mesh.html#bluetooth-meshtuya">
            
                    
                    Bluetooth Mesh(TUYA)
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.1.3.1" data-path="Mesh.html">
            
                <a href="Mesh.html#prepare">
            
                    
                    Prepare
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.3.2" data-path="Mesh.html">
            
                <a href="Mesh.html#basic-notion">
            
                    
                    Basic Notion
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.3.3" data-path="Mesh.html">
            
                <a href="Mesh.html#management">
            
                    
                    Management
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.3.4" data-path="Mesh.html">
            
                <a href="Mesh.html#activation">
            
                    
                    Activation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.3.5" data-path="Mesh.html">
            
                <a href="Mesh.html#device">
            
                    
                    Device
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.3.6" data-path="Mesh.html">
            
                <a href="Mesh.html#group">
            
                    
                    Group
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.3.7" data-path="Mesh.html">
            
                <a href="Mesh.html#control">
            
                    
                    Control
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.3.8" data-path="Mesh.html">
            
                <a href="Mesh.html#firmware-upgrade">
            
                    
                    Firmware Upgrade
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    

    
        
        <li class="divider"></li>
        
        
    
        <li class="chapter " data-level="3.1" data-path="ExtensionAbout.html">
            
                <a href="ExtensionAbout.html">
            
                    
                    Extension SDK
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.1.1" data-path="Camera.html">
            
                <a href="Camera.html">
            
                    
                    IPC SDK
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.1.1.1" data-path="ipc/rapid_integration.html">
            
                <a href="ipc/rapid_integration.html">
            
                    
                    Integrate SDK
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.1.2" data-path="ipc/architecture.html">
            
                <a href="ipc/architecture.html">
            
                    
                    SDK Architecture
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.1.3" data-path="ipc/camera_device.html">
            
                <a href="ipc/camera_device.html">
            
                    
                    Camera Device
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.1.4" data-path="ipc/activitor.html">
            
                <a href="ipc/activitor.html">
            
                    
                    Device Configuration
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.1.5" data-path="ipc/live.html">
            
                <a href="ipc/live.html">
            
                    
                    Camera Features
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.1.1.5.1" data-path="ipc/live.html">
            
                <a href="ipc/live.html#live-video">
            
                    
                    Live Video
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.1.5.2" data-path="ipc/playback.html">
            
                <a href="ipc/playback.html">
            
                    
                    Playback
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.1.5.3" data-path="ipc/av_function.html">
            
                <a href="ipc/av_function.html">
            
                    
                    AV Functions
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="3.1.1.6" data-path="ipc/cloud_video.html">
            
                <a href="ipc/cloud_video.html">
            
                    
                    Cloud Storage
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.1.1.6.1" data-path="ipc/cloud_video.html">
            
                <a href="ipc/cloud_video.html#flow-chart">
            
                    
                    Flow Chart
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.1.6.2" data-path="ipc/cloud_video.html">
            
                <a href="ipc/cloud_video.html#cloud-service">
            
                    
                    Cloud Service
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.1.6.3" data-path="ipc/cloud_video.html">
            
                <a href="ipc/cloud_video.html#cloud-video">
            
                    
                    Cloud Video
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="3.1.1.7" data-path="ipc/device_points.html">
            
                <a href="ipc/device_points.html">
            
                    
                    Extension Features
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.1.1.7.1" data-path="ipc/device_points.html">
            
                <a href="ipc/device_points.html#data-point-id">
            
                    
                    Data Point Id
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.1.7.2" data-path="ipc/lowpower.html">
            
                <a href="ipc/lowpower.html">
            
                    
                    Doorbell
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.1.7.3" data-path="ipc/sd_card.html">
            
                <a href="ipc/sd_card.html">
            
                    
                    Memory Card
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.1.7.4" data-path="ipc/ptz.html">
            
                <a href="ipc/ptz.html">
            
                    
                    PTZ
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="3.1.1.8" data-path="ipc/detect.html">
            
                <a href="ipc/detect.html">
            
                    
                    Detection Alarm
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.1.1.8.1" data-path="ipc/detect.html">
            
                <a href="ipc/detect.html#message-list">
            
                    
                    Message List
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.1.8.2" data-path="ipc/detect.html">
            
                <a href="ipc/detect.html#video-message">
            
                    
                    Video Message
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="3.1.1.9" data-path="ipc/encryptImage.html">
            
                <a href="ipc/encryptImage.html">
            
                    
                    Encrypted Image
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.1.10" data-path="ipc/timeline.html">
            
                <a href="ipc/timeline.html">
            
                    
                    Timeline View
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.1.11" data-path="ipc/errors.html">
            
                <a href="ipc/errors.html">
            
                    
                    Error Codes
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.1.12" data-path="ipc/required_permission.html">
            
                <a href="ipc/required_permission.html">
            
                    
                    Permissions
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.1.13" data-path="ipc/log_file.html">
            
                <a href="ipc/log_file.html">
            
                    
                    Debug logs
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.1.14" data-path="ipc/FAQ.html">
            
                <a href="ipc/FAQ.html">
            
                    
                    FAQ
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.1.15" data-path="ipc/version_record.html">
            
                <a href="ipc/version_record.html">
            
                    
                    Change Log
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="3.1.2" data-path="Sweeper.html">
            
                <a href="Sweeper.html#Sweeper-sdk">
            
                    
                    Sweeper SDK
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.1.2.1" data-path="SweeperInterface.html">
            
                <a href="SweeperInterface.html">
            
                    
                    Gyroscope and Visual Sweeper
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.2.2" data-path="SweeperLaser.html">
            
                <a href="SweeperLaser.html">
            
                    
                    Laser Sweeper
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.2.3" data-path="SweeperVoiceDownload.html">
            
                <a href="SweeperVoiceDownload.html">
            
                    
                    Voice Package Download
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.2.4" data-path="SweeperWordIntroduction.html">
            
                <a href="SweeperWordIntroduction.html">
            
                    
                    Glossary
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.2.5" data-path="SweeperChangeLog.html">
            
                <a href="SweeperChangeLog.html">
            
                    
                    Change Log
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="3.1.3" data-path="Lock.html">
            
                <a href="Lock.html">
            
                    
                    Smart Lock SDK
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.1.3.1" data-path="WiFiLock.html">
            
                <a href="WiFiLock.html">
            
                    
                    Wi-Fi Lock
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.3.2" data-path="BLELock.html">
            
                <a href="BLELock.html">
            
                    
                    BLE Lock
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    

    
        
        <li class="divider"></li>
        
        
    
        <li class="chapter " data-level="4.1" >
            
                <a target="_blank" href="https://tuyainc.github.io/tuyasmart_home_ios_sdk_api_reference/index.html">
            
                    
                    API Reference
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.2" data-path="CommonInterface.html">
            
                <a href="CommonInterface.html">
            
                    
                    Common Interface
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.3" data-path="ErrorCode.html">
            
                <a href="ErrorCode.html">
            
                    
                    Error Code
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.4" data-path="Faq.html">
            
                <a href="Faq.html">
            
                    
                    FAQ
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.5" data-path="ChangeLog.html">
            
                <a href="ChangeLog.html">
            
                    
                    ChangeLog
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >Bluetooth Mesh(TUYA)</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <div id="anchor-navigation-ex-navbar"><i class="fa fa-navicon"></i><ul><li><span class="title-icon "></span><a href="#bluetooth-meshtuya"><b>1. </b>Bluetooth Mesh(TUYA)</a></li><ul><li><span class="title-icon "></span><a href="#prepare"><b>1.1. </b>Prepare</a></li><li><span class="title-icon "></span><a href="#basic-notion"><b>1.2. </b>Basic Notion</a></li><li><span class="title-icon "></span><a href="#management"><b>1.3. </b>Management</a></li><ul><li><span class="title-icon "></span><a href="#create-mesh"><b>1.3.1. </b>Create Mesh</a></li><li><span class="title-icon "></span><a href="#delete-mesh"><b>1.3.2. </b>Delete Mesh</a></li><li><span class="title-icon "></span><a href="#get-the-list-of-mesh-in-the-family"><b>1.3.3. </b>Get The List Of Mesh In The Family</a></li><li><span class="title-icon "></span><a href="#get-mesh-instance"><b>1.3.4. </b>Get Mesh Instance</a></li><li><span class="title-icon "></span><a href="#mesh-sub-devicess-connect"><b>1.3.5. </b>Mesh Sub-devices&apos;s Connect</a></li></ul><li><span class="title-icon "></span><a href="#activation"><b>1.4. </b>Activation</a></li><ul><li><span class="title-icon "></span><a href="#device-reset"><b>1.4.1. </b>Device Reset</a></li><li><span class="title-icon "></span><a href="#scan-mesh-device"><b>1.4.2. </b>Scan Mesh Device</a></li><li><span class="title-icon "></span><a href="#active-mesh-device-by-bluetooth"><b>1.4.3. </b>Active Mesh Device By Bluetooth</a></li><li><span class="title-icon "></span><a href="#active-mesh-gateway-device"><b>1.4.4. </b>Active Mesh Gateway Device</a></li><li><span class="title-icon "></span><a href="#error-code"><b>1.4.5. </b>Error Code</a></li></ul><li><span class="title-icon "></span><a href="#device"><b>1.5. </b>Device</a></li><ul><li><span class="title-icon "></span><a href="#rename-device"><b>1.5.1. </b>Rename Device</a></li><li><span class="title-icon "></span><a href="#local-connection-and-gateway-connection"><b>1.5.2. </b>Local Connection and Gateway Connection</a></li><li><span class="title-icon "></span><a href="#remove-device"><b>1.5.3. </b>Remove Device</a></li><li><span class="title-icon "></span><a href="#query-mesh-device-status"><b>1.5.4. </b>Query Mesh Device Status</a></li></ul><li><span class="title-icon "></span><a href="#group"><b>1.6. </b>Group</a></li><ul><li><span class="title-icon "></span><a href="#create-group"><b>1.6.1. </b>Create Group</a></li><li><span class="title-icon "></span><a href="#add-device-to-group"><b>1.6.2. </b>Add Device to Group</a></li><li><span class="title-icon "></span><a href="#remove-device-from-group"><b>1.6.3. </b>Remove Device From Group</a></li><li><span class="title-icon "></span><a href="#get-group-instance"><b>1.6.4. </b>Get Group Instance</a></li><li><span class="title-icon "></span><a href="#update-group-name"><b>1.6.5. </b>Update Group Name</a></li><li><span class="title-icon "></span><a href="#remove-device-from-group_1"><b>1.6.6. </b>Remove Device From Group</a></li><li><span class="title-icon "></span><a href="#get-devices-from-group"><b>1.6.7. </b>Get Devices From Group</a></li></ul><li><span class="title-icon "></span><a href="#control"><b>1.7. </b>Control</a></li><ul><li><span class="title-icon "></span><a href="#control-command---control-devices"><b>1.7.1. </b>Control Command - Control Devices</a></li><li><span class="title-icon "></span><a href="#control-command---control-group"><b>1.7.2. </b>Control Command - Control Group</a></li></ul><li><span class="title-icon "></span><a href="#firmware-upgrade"><b>1.8. </b>Firmware Upgrade</a></li><ul><li><span class="title-icon "></span><a href="#query-firmware-info"><b>1.8.1. </b>Query Firmware Info</a></li><li><span class="title-icon "></span><a href="#sub-device-upgrade"><b>1.8.2. </b>Sub-Device Upgrade</a></li></ul></ul></ul></div><h1 id="bluetooth-meshtuya"><a name="bluetooth-meshtuya" class="anchor-navigation-ex-anchor" href="#bluetooth-meshtuya"><i class="fa fa-link" aria-hidden="true"></i></a>1. Bluetooth Mesh(TUYA)</h1>
<p>Generally speaking, Bluetooth mesh is to form a mesh network with multiple Bluetooth single-point devices. Each node can communicate with other nodes freely. By directly connecting to any device in the mesh network via mobile phone <strong>, you can access and control the mesh network All equipment </strong></p>
<table>
<thead>
<tr>
<th>Class name</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>TYBLEMeshManager</td>
<td>Bluetooth Mesh Class</td>
</tr>
</tbody>
</table>
<h2 id="prepare"><a name="prepare" class="anchor-navigation-ex-anchor" href="#prepare"><i class="fa fa-link" aria-hidden="true"></i></a>1.1. Prepare</h2>
<pre class="language-"><code class="lang-objective-c">
  <span class="token comment">// set sdk open mesh, need to be set during initialization</span>
  <span class="token punctuation">[</span><span class="token punctuation">[</span>TuyaSmartSDK sharedInstance<span class="token punctuation">]</span> setValue<span class="token punctuation">:</span><span class="token operator">@</span><span class="token punctuation">(</span>YES<span class="token punctuation">)</span> forKey<span class="token punctuation">:</span><span class="token string">@&quot;bleMeshEnable&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre>
<h2 id="basic-notion"><a name="basic-notion" class="anchor-navigation-ex-anchor" href="#basic-notion"><i class="fa fa-link" aria-hidden="true"></i></a>1.2. Basic Notion</h2>
<table>
<thead>
<tr>
<th>Basic Notion</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>pcc</td>
<td>Each mesh device corresponds to a product, and each product has its own size class label. The SDK uses pcc andtype as the size class label.</td>
</tr>
<tr>
<td>mesh node Id</td>
<td>The node id is used to distinguish the &quot;unique identifier&quot; of each mesh device in the mesh network. For example, if you want to control a device, you can send the nodeId command corresponding to this device to the mesh network</td>
</tr>
<tr>
<td>mesh group local Id</td>
<td>The local Id is used to distinguish the `` unique identifier &apos;&apos; of each mesh group in the mesh network.For example, if you want to control the devices in a group, you can send the localId command corresponding to this group to the mesh network.</td>
</tr>
<tr>
<td>Local Connection</td>
<td>The networked device is connected via Bluetooth to control mesh and command operations</td>
</tr>
<tr>
<td>Gateway Connection</td>
<td>The networked devices are connected through the gateway (the gateway needs to be with the device, and the distance cannot be too far) to control the mesh and command operations.</td>
</tr>
</tbody>
</table>
<p>  Mesh product type</p>
<pre class="language-"><code class="lang-objective-c">    <span class="token function">light</span><span class="token punctuation">(</span><span class="token number">01</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token operator">-</span><span class="token number">5</span>  RGBWC 
    <span class="token keyword">switch</span><span class="token punctuation">(</span><span class="token number">02</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token operator">-</span><span class="token number">6</span> 
    <span class="token function">sensor</span><span class="token punctuation">(</span><span class="token number">04</span><span class="token punctuation">)</span><span class="token punctuation">:</span> 
    <span class="token function">Actuator</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">:</span> Alarm
    <span class="token function">adapter</span><span class="token punctuation">(</span><span class="token number">08</span><span class="token punctuation">)</span><span class="token punctuation">:</span> gateway&#xFF08;
</code></pre>
<p>  sub product type</p>
<pre class="language-"><code class="lang-objective-c">    <span class="token number">1</span><span class="token operator">-</span><span class="token number">5</span> light&#xFF08;<span class="token number">01</span><span class="token operator">-</span><span class="token number">05</span>&#xFF09;
    <span class="token number">1</span><span class="token operator">-</span><span class="token number">6</span> swicth&#xFF08;<span class="token number">01</span><span class="token operator">-</span><span class="token number">06</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
</code></pre>
<p>  pcc example</p>
<pre class="language-"><code class="lang-objective-c">     rgb light   <span class="token number">0301</span>
     rgbwc light <span class="token number">0501</span>
     <span class="token number">5</span> <span class="token keyword">switch</span>    <span class="token number">0502</span>
     gateway     <span class="token number">0108</span>
     <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
</code></pre>
<p><strong>Equipment operation requires multiple steps</strong></p>
<p>Because device operations, such as adding and deleting operations, and group operations, require the local Bluetooth command to be executed once and recorded in the cloud once. The operation information needs to be synchronized to the local mesh network as well.</p>
<h2 id="management"><a name="management" class="anchor-navigation-ex-anchor" href="#management"><i class="fa fa-link" aria-hidden="true"></i></a>1.3. Management</h2>
<blockquote>
<p><code>TuyaSmartBleMesh.h</code></p>
</blockquote>
<h3 id="create-mesh"><a name="create-mesh" class="anchor-navigation-ex-anchor" href="#create-mesh"><i class="fa fa-link" aria-hidden="true"></i></a>1.3.1. Create Mesh</h3>
<p>A family can have multiple sig meshes (it is recommended to create only one family). All operations in the sig mesh are based on the family data being initialized.</p>
<blockquote>
<p>Init home <a href="https://tuyainc.github.io/tuyasmart_home_ios_sdk_doc/en/resource/Home.html#home-management" target="_blank">See</a></p>
</blockquote>
<p><strong>Declaration</strong></p>
<pre class="language-"><code class="lang-objective-c"><span class="token operator">+</span> <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>createBleMeshWithMeshName<span class="token punctuation">:</span><span class="token punctuation">(</span>NSString <span class="token operator">*</span><span class="token punctuation">)</span>meshName
                           homeId<span class="token punctuation">:</span><span class="token punctuation">(</span><span class="token keyword">long</span> <span class="token keyword">long</span><span class="token punctuation">)</span>homeId
                          success<span class="token punctuation">:</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">(</span><span class="token operator">^</span><span class="token punctuation">)</span><span class="token punctuation">(</span>TuyaSmartBleMeshModel <span class="token operator">*</span>meshModel<span class="token punctuation">)</span><span class="token punctuation">)</span>success
                          failure<span class="token punctuation">:</span><span class="token punctuation">(</span>TYFailureError<span class="token punctuation">)</span>failure<span class="token punctuation">;</span>
</code></pre>
<p><strong>Parameters</strong></p>
<table>
<thead>
<tr>
<th>parameter</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>meshName</td>
<td>mesh name</td>
</tr>
<tr>
<td>homeId</td>
<td>homeId</td>
</tr>
<tr>
<td>success</td>
<td>success block</td>
</tr>
<tr>
<td>failure</td>
<td>failure block</td>
</tr>
</tbody>
</table>
<p><strong>Example</strong></p>
<pre class="language-"><code class="lang-objective-c">TuyaSmartHome <span class="token operator">*</span>home <span class="token operator">=</span> #<span class="token operator">&lt;</span> home instance<span class="token operator">&gt;</span><span class="token punctuation">;</span>
<span class="token keyword">long</span> <span class="token keyword">long</span> homeId <span class="token operator">=</span> home<span class="token punctuation">.</span>homeModel<span class="token punctuation">.</span>homeId<span class="token punctuation">;</span>
<span class="token punctuation">[</span>TuyaSmartBleMesh createBleMeshWithMeshName<span class="token punctuation">:</span><span class="token string">@&quot;yourMeshName&quot;</span> homeId<span class="token punctuation">:</span>homeId success<span class="token punctuation">:</span><span class="token operator">^</span><span class="token punctuation">(</span>TuyaSmartBleMeshModel <span class="token operator">*</span>meshModel<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// success do...</span>
<span class="token punctuation">}</span> failure<span class="token punctuation">:</span><span class="token operator">^</span><span class="token punctuation">(</span>NSError <span class="token operator">*</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">NSLog</span><span class="token punctuation">(</span><span class="token string">@&quot;create mesh error: %@&quot;</span><span class="token punctuation">,</span> error<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre>
<blockquote>
<p>The meshName of this method is custom, and it is recommended to set it with unique parameters, such as &quot;mesh + timestamp form&quot;</p>
</blockquote>
<h3 id="delete-mesh"><a name="delete-mesh" class="anchor-navigation-ex-anchor" href="#delete-mesh"><i class="fa fa-link" aria-hidden="true"></i></a>1.3.2. Delete Mesh</h3>
<p><strong>Declaration</strong></p>
<p>Delete the mesh. If there are devices in the mesh group, the child devices are also removed. The Wi-Fi connector was also removed.</p>
<pre class="language-"><code class="lang-objective-c"><span class="token operator">-</span> <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>removeMeshWithSuccess<span class="token punctuation">:</span><span class="token punctuation">(</span>TYSuccessHandler<span class="token punctuation">)</span>success failure<span class="token punctuation">:</span><span class="token punctuation">(</span>TYFailureError<span class="token punctuation">)</span>failure<span class="token punctuation">;</span>
</code></pre>
<p><strong>Parameters</strong></p>
<table>
<thead>
<tr>
<th>parameter</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>success</td>
<td>success block</td>
</tr>
<tr>
<td>failure</td>
<td>failure block</td>
</tr>
</tbody>
</table>
<p><strong>Example</strong></p>
<pre class="language-"><code class="lang-objective-c"><span class="token keyword">self</span><span class="token punctuation">.</span>mesh <span class="token operator">=</span> #<span class="token operator">&lt;</span>TuyaSmartBleMesh instance<span class="token operator">&gt;</span><span class="token punctuation">;</span>
<span class="token punctuation">[</span><span class="token keyword">self</span><span class="token punctuation">.</span>mesh removeMeshWithSuccess<span class="token punctuation">:</span><span class="token operator">^</span><span class="token punctuation">{</span>
    <span class="token comment">// success do...</span>
<span class="token punctuation">}</span> failure<span class="token punctuation">:</span><span class="token operator">^</span><span class="token punctuation">(</span>NSError <span class="token operator">*</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">XCTFail</span><span class="token punctuation">(</span><span class="token string">@&quot;test remove mesh failure: %@&quot;</span><span class="token punctuation">,</span> error<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre>
<h3 id="get-the-list-of-mesh-in-the-family"><a name="get-the-list-of-mesh-in-the-family" class="anchor-navigation-ex-anchor" href="#get-the-list-of-mesh-in-the-family"><i class="fa fa-link" aria-hidden="true"></i></a>1.3.3. Get The List Of Mesh In The Family</h3>
<p>After initializing the home instance, you can get the mesh list of the corresponding family</p>
<p>Get the list of meshes under the family</p>
<p><strong>Declaration</strong></p>
<pre class="language-"><code class="lang-objective-c"><span class="token operator">-</span> <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>getMeshListWithSuccess<span class="token punctuation">:</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">(</span><span class="token operator">^</span><span class="token punctuation">)</span><span class="token punctuation">(</span>NSArray <span class="token operator">&lt;</span>TuyaSmartBleMeshModel <span class="token operator">*</span><span class="token operator">&gt;</span> <span class="token operator">*</span>list<span class="token punctuation">)</span><span class="token punctuation">)</span>success
                       failure<span class="token punctuation">:</span><span class="token punctuation">(</span>TYFailureError<span class="token punctuation">)</span>failure<span class="token punctuation">;</span>
</code></pre>
<p><strong>Parameters</strong></p>
<table>
<thead>
<tr>
<th>parameter</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>success</td>
<td>success block</td>
</tr>
<tr>
<td>failure</td>
<td>failure block</td>
</tr>
</tbody>
</table>
<p><strong>Example</strong></p>
<pre class="language-"><code class="lang-objective-c">TuyaSmartHome <span class="token operator">*</span>home <span class="token operator">=</span> #<span class="token operator">&lt;</span>home instance<span class="token operator">&gt;</span>
<span class="token punctuation">[</span>home getMeshListWithSuccess<span class="token punctuation">:</span><span class="token operator">^</span><span class="token punctuation">(</span>NSArray<span class="token operator">&lt;</span>TuyaSmartBleMeshModel <span class="token operator">*</span><span class="token operator">&gt;</span> <span class="token operator">*</span>list<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// success do</span>
<span class="token punctuation">}</span> failure<span class="token punctuation">:</span><span class="token operator">^</span><span class="token punctuation">(</span>NSError <span class="token operator">*</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">NSLog</span><span class="token punctuation">(</span><span class="token string">@&quot;get mesh list error: %@&quot;</span><span class="token punctuation">,</span> error<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre>
<h3 id="get-mesh-instance"><a name="get-mesh-instance" class="anchor-navigation-ex-anchor" href="#get-mesh-instance"><i class="fa fa-link" aria-hidden="true"></i></a>1.3.4. Get Mesh Instance</h3>
<p><strong>Declaration</strong></p>
<pre class="language-"><code class="lang-objective-c"><span class="token operator">+</span> <span class="token punctuation">(</span>instancetype<span class="token punctuation">)</span>bleMeshWithMeshId<span class="token punctuation">:</span><span class="token punctuation">(</span>NSString <span class="token operator">*</span><span class="token punctuation">)</span>meshId homeId<span class="token punctuation">:</span><span class="token punctuation">(</span><span class="token keyword">long</span> <span class="token keyword">long</span><span class="token punctuation">)</span>homeId<span class="token punctuation">;</span>
</code></pre>
<p><strong>Parameters</strong></p>
<table>
<thead>
<tr>
<th>parameter</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>meshId</td>
<td>mesh id</td>
</tr>
<tr>
<td>homeId</td>
<td>home id</td>
</tr>
</tbody>
</table>
<p><strong>Example</strong></p>
<p>Through the family (TuyaSmartHome instance), home can get the meshModel under the class, which can be created through this, and after the creation is completed, it is assigned to the current TuyaSmartUser, and the SDK and upper layers take the value of TuyaSmartUser as the judgment criterion:</p>
<pre class="language-"><code class="lang-objective-c">
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">[</span>TuyaSmartUser sharedInstance<span class="token punctuation">]</span><span class="token punctuation">.</span>meshModel <span class="token operator">==</span> nil<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    TuyaSmartHome <span class="token operator">*</span>home <span class="token operator">=</span> #<span class="token operator">&lt;</span>home instance<span class="token operator">&gt;</span>
    <span class="token punctuation">[</span>home getMeshListWithSuccess<span class="token punctuation">:</span><span class="token operator">^</span><span class="token punctuation">(</span>NSArray<span class="token operator">&lt;</span>TuyaSmartBleMeshModel <span class="token operator">*</span><span class="token operator">&gt;</span> <span class="token operator">*</span>list<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>list<span class="token punctuation">.</span>count <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

                <span class="token punctuation">[</span>TuyaSmartUser sharedInstance<span class="token punctuation">]</span><span class="token punctuation">.</span>meshModel <span class="token operator">=</span> home<span class="token punctuation">.</span>meshModel<span class="token punctuation">;</span>
                <span class="token punctuation">[</span>TuyaSmartUser sharedInstance<span class="token punctuation">]</span><span class="token punctuation">.</span>mesh <span class="token operator">=</span> <span class="token punctuation">[</span>TuyaSmartBleMesh bleMeshWithMeshId<span class="token punctuation">:</span>home<span class="token punctuation">.</span>meshModel<span class="token punctuation">.</span>meshId homeId<span class="token punctuation">:</span>home<span class="token punctuation">.</span>meshModel<span class="token punctuation">.</span>homeId<span class="token punctuation">]</span><span class="token punctuation">;</span>


            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>

                NSTimeInterval interval <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span>NSDate date<span class="token punctuation">]</span> timeIntervalSince1970<span class="token punctuation">]</span><span class="token punctuation">;</span>
                NSString <span class="token operator">*</span>meshName <span class="token operator">=</span> <span class="token punctuation">[</span>NSString stringWithFormat<span class="token punctuation">:</span><span class="token string">@&quot;tymesh%.0f&quot;</span><span class="token punctuation">,</span> interval<span class="token punctuation">]</span><span class="token punctuation">;</span>

                <span class="token punctuation">[</span>TuyaSmartBleMesh createBleMeshWithMeshName<span class="token punctuation">:</span>meshName homeId<span class="token punctuation">:</span>home<span class="token punctuation">.</span>homeModel<span class="token punctuation">.</span>homeId success<span class="token punctuation">:</span><span class="token operator">^</span><span class="token punctuation">(</span>TuyaSmartBleMeshModel <span class="token operator">*</span>meshModel<span class="token punctuation">)</span> <span class="token punctuation">{</span>

                    <span class="token punctuation">[</span>TuyaSmartUser sharedInstance<span class="token punctuation">]</span><span class="token punctuation">.</span>meshModel <span class="token operator">=</span> meshModel<span class="token punctuation">;</span>
                    <span class="token punctuation">[</span>TuyaSmartUser sharedInstance<span class="token punctuation">]</span><span class="token punctuation">.</span>mesh <span class="token operator">=</span> <span class="token punctuation">[</span>TuyaSmartBleMesh bleMeshWithMeshId<span class="token punctuation">:</span>meshModel<span class="token punctuation">.</span>meshId homeId<span class="token punctuation">:</span>home<span class="token punctuation">.</span>homeModel<span class="token punctuation">.</span>homeId<span class="token punctuation">]</span><span class="token punctuation">;</span>


                <span class="token punctuation">}</span> failure<span class="token punctuation">:</span><span class="token operator">^</span><span class="token punctuation">(</span>NSError <span class="token operator">*</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>

                <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span> failure<span class="token punctuation">:</span><span class="token operator">^</span><span class="token punctuation">(</span>NSError <span class="token operator">*</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>

<span class="token punctuation">}</span>
</code></pre>
<h3 id="mesh-sub-devicess-connect"><a name="mesh-sub-devicess-connect" class="anchor-navigation-ex-anchor" href="#mesh-sub-devicess-connect"><i class="fa fa-link" aria-hidden="true"></i></a>1.3.5. Mesh Sub-devices&apos;s Connect</h3>
<p>Network access is the operation of connecting to the mesh network through a networked device. This process requires Bluetooth to be turned on.</p>
<p>If the operation is distribution network, fill in the default mesh name and password. At this time, it will only pass the <code>TYBLEMeshManagerDelegate</code>
<code>- (void)bleMeshManager:(TYBLEMeshManager *)manager didScanedDevice:(TYBleMeshDeviceModel *)device;</code> </p>
<p>If the operation is to enter the network, fill in the created mesh name and password. This information is returned from the cloud interface. It can automatically connect, enter the network, and automatically obtain the online status of each device in the mesh network.</p>
<p><strong>Declaration</strong></p>
<p>mesh start</p>
<pre class="language-"><code class="lang-objective-c"><span class="token operator">-</span> <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>startScanWithName<span class="token punctuation">:</span><span class="token punctuation">(</span>NSString <span class="token operator">*</span><span class="token punctuation">)</span>name
                      pwd<span class="token punctuation">:</span><span class="token punctuation">(</span>NSString <span class="token operator">*</span><span class="token punctuation">)</span>pwd
                   active<span class="token punctuation">:</span><span class="token punctuation">(</span>BOOL<span class="token punctuation">)</span>active
              wifiAddress<span class="token punctuation">:</span><span class="token punctuation">(</span>uint32_t<span class="token punctuation">)</span>wifiAddress
               otaAddress<span class="token punctuation">:</span><span class="token punctuation">(</span>uint32_t<span class="token punctuation">)</span>otaAddress<span class="token punctuation">;</span>
</code></pre>
<p><strong>Parameters</strong></p>
<table>
<thead>
<tr>
<th>parameter</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>name</td>
<td>mesh name</td>
</tr>
<tr>
<td>pwd</td>
<td>mesh password</td>
</tr>
<tr>
<td>active</td>
<td>is active</td>
</tr>
<tr>
<td>wifiAddress</td>
<td>Wi-Fi address, required for gateway network configuration, the rest is 0</td>
</tr>
<tr>
<td>otaAddress</td>
<td>ota device address, required for ota upgrade, the rest is 0</td>
</tr>
</tbody>
</table>
<p><strong>Declaration</strong></p>
<p>Successful network access will automatically obtain the online status of the devices in the mesh network and trigger the <code>TuyaSmartHomeDelegate</code> delegate method to call back information</p>
<pre class="language-"><code class="lang-objective-c"><span class="token operator">-</span> <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>home<span class="token punctuation">:</span><span class="token punctuation">(</span>TuyaSmartHome <span class="token operator">*</span><span class="token punctuation">)</span>home deviceInfoUpdate<span class="token punctuation">:</span><span class="token punctuation">(</span>TuyaSmartDeviceModel <span class="token operator">*</span><span class="token punctuation">)</span>device<span class="token punctuation">;</span>
</code></pre>
<p><strong>Example</strong></p>
<pre class="language-"><code class="lang-objective-c">
<span class="token punctuation">[</span><span class="token punctuation">[</span>TYBLEMeshManager sharedInstance<span class="token punctuation">]</span> startScanWithName<span class="token punctuation">:</span><span class="token punctuation">[</span>TuyaSmartUser sharedInstance<span class="token punctuation">]</span><span class="token punctuation">.</span>meshModel<span class="token punctuation">.</span>code pwd<span class="token punctuation">:</span><span class="token punctuation">[</span>TuyaSmartUser sharedInstance<span class="token punctuation">]</span><span class="token punctuation">.</span>meshModel<span class="token punctuation">.</span>password active<span class="token punctuation">:</span>NO wifiAddress<span class="token punctuation">:</span><span class="token number">0</span> otaAddress<span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token operator">-</span> <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>home<span class="token punctuation">:</span><span class="token punctuation">(</span>TuyaSmartHome <span class="token operator">*</span><span class="token punctuation">)</span>home deviceInfoUpdate<span class="token punctuation">:</span><span class="token punctuation">(</span>TuyaSmartDeviceModel <span class="token operator">*</span><span class="token punctuation">)</span>device <span class="token punctuation">{</span>
    <span class="token comment">// callback</span>
<span class="token punctuation">}</span>
</code></pre>
<h2 id="activation"><a name="activation" class="anchor-navigation-ex-anchor" href="#activation"><i class="fa fa-link" aria-hidden="true"></i></a>1.4. Activation</h2>
<blockquote>
<p> <code>TYBLEMeshManager</code> </p>
</blockquote>
<p>The distribution network refers to adding devices that are in the reset state and not connected to the sig mesh network.</p>
<p>The following is a list of common device reset methods</p>
<h3 id="device-reset"><a name="device-reset" class="anchor-navigation-ex-anchor" href="#device-reset"><i class="fa fa-link" aria-hidden="true"></i></a>1.4.1. Device Reset</h3>
<table>
<thead>
<tr>
<th>Product</th>
<th>reset</th>
<th>show</th>
</tr>
</thead>
<tbody>
<tr>
<td>Light</td>
<td>Three consecutive switches</td>
<td>flashes quickly</td>
</tr>
<tr>
<td>Switch</td>
<td>Long press 3s</td>
<td>flashes quickly</td>
</tr>
<tr>
<td>Gateway</td>
<td>Long press 3s</td>
<td>flashes quickly</td>
</tr>
</tbody>
</table>
<p>The device in the reset state, the default name is <code>out_of_mesh</code>, and the default password is <code>123456</code></p>
<h3 id="scan-mesh-device"><a name="scan-mesh-device" class="anchor-navigation-ex-anchor" href="#scan-mesh-device"><i class="fa fa-link" aria-hidden="true"></i></a>1.4.2. Scan Mesh Device</h3>
<blockquote>
<p>In order to simplify scanning and subsequent distribution operations, all operations are unified into one interface.</p>
</blockquote>
<p>If the operation is distribution network, fill in the default mesh name and password. At this time, it will only pass the <code>TYBLEMeshManagerDelegate</code>
<code>- (void)bleMeshManager:(TYBLEMeshManager *)manager didScanedDevice:(TYBleMeshDeviceModel *)device;</code> </p>
<p>If the operation is to enter the network, fill in the created mesh name and password. This information is returned from the cloud interface. It can automatically connect, enter the network, and automatically obtain the online status of each device in the mesh network.</p>
<p><strong>Declaration</strong></p>
<pre class="language-"><code class="lang-objective-c"><span class="token operator">-</span> <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>startScanWithName<span class="token punctuation">:</span><span class="token punctuation">(</span>NSString <span class="token operator">*</span><span class="token punctuation">)</span>name
                      pwd<span class="token punctuation">:</span><span class="token punctuation">(</span>NSString <span class="token operator">*</span><span class="token punctuation">)</span>pwd
                   active<span class="token punctuation">:</span><span class="token punctuation">(</span>BOOL<span class="token punctuation">)</span>active
              wifiAddress<span class="token punctuation">:</span><span class="token punctuation">(</span>uint32_t<span class="token punctuation">)</span>wifiAddress
               otaAddress<span class="token punctuation">:</span><span class="token punctuation">(</span>uint32_t<span class="token punctuation">)</span>otaAddress<span class="token punctuation">;</span>
</code></pre>
<p><strong>Parameters</strong></p>
<table>
<thead>
<tr>
<th>parameter</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>name</td>
<td>mesh name</td>
</tr>
<tr>
<td>pwd</td>
<td>mesh password</td>
</tr>
<tr>
<td>wifiAddress</td>
<td>Wi-Fi address, required for gateway network configuration, the rest is 0</td>
</tr>
<tr>
<td>otaAddress</td>
<td>ota device address, required for ota upgrade, the rest is 0</td>
</tr>
</tbody>
</table>
<p>If the name passed in is the default value out_of_mesh, and it is an activation operation, it will scan the surrounding devices to be configured, and the result of the scan will be called back by the method in TYBLEMeshManagerDelegate</p>
<p><strong>Declaration</strong></p>
<pre class="language-"><code class="lang-objective-c"><span class="token comment">/**
 Scanning to devices to be configured
 */</span>
<span class="token operator">-</span> <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>bleMeshManager<span class="token punctuation">:</span><span class="token punctuation">(</span>TYBLEMeshManager <span class="token operator">*</span><span class="token punctuation">)</span>manager didScanedDevice<span class="token punctuation">:</span><span class="token punctuation">(</span>TYBleMeshDeviceModel <span class="token operator">*</span><span class="token punctuation">)</span>device<span class="token punctuation">;</span>
</code></pre>
<p><strong>Parameters</strong></p>
<table>
<thead>
<tr>
<th>parameter</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>manager</td>
<td>mesh manager</td>
</tr>
<tr>
<td>device</td>
<td>un active devices</td>
</tr>
</tbody>
</table>
<p>If it is a network access operation, subsequent operations will be performed automatically without callback.</p>
<p><strong>Example</strong></p>
<pre class="language-"><code class="lang-objective-c"><span class="token comment">// start scan</span>
<span class="token punctuation">[</span><span class="token punctuation">[</span>TYBLEMeshManager sharedInstance<span class="token punctuation">]</span> startScanWithName<span class="token punctuation">:</span><span class="token string">@&quot;out_of_mesh&quot;</span> pwd<span class="token punctuation">:</span><span class="token string">@&quot;123456&quot;</span> active<span class="token punctuation">:</span>YES wifiAddress<span class="token punctuation">:</span><span class="token number">0</span> otaAddress<span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token comment">// TYBLEMeshManagerDelegate </span>
<span class="token operator">-</span> <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>bleMeshManager<span class="token punctuation">:</span><span class="token punctuation">(</span>TYBLEMeshManager <span class="token operator">*</span><span class="token punctuation">)</span>manager didScanedDevice<span class="token punctuation">:</span><span class="token punctuation">(</span>TYBleMeshDeviceModel <span class="token operator">*</span><span class="token punctuation">)</span>device <span class="token punctuation">{</span>

    <span class="token comment">// The scanned gateway devices and sub-devices will be called back by this method</span>
    <span class="token comment">// Use device.type and device.vendorInfo to determine if it is a mesh gateway</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>device<span class="token punctuation">.</span>type <span class="token operator">==</span> <span class="token punctuation">[</span>TPUtils getIntValueByHex<span class="token punctuation">:</span><span class="token string">@&quot;0x0108&quot;</span><span class="token punctuation">]</span> <span class="token operator">||</span> <span class="token punctuation">(</span><span class="token punctuation">[</span>TPUtils getIntValueByHex<span class="token punctuation">:</span><span class="token punctuation">[</span>device<span class="token punctuation">.</span>vendorInfo substringWithRange<span class="token punctuation">:</span><span class="token function">NSMakeRange</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">0x08</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0x08</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token comment">// mesh gateway</span>
        <span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token comment">// mesh sub node device </span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// getIntValueByHex</span>
<span class="token operator">+</span> <span class="token punctuation">(</span>uint32_t<span class="token punctuation">)</span>getIntValueByHex<span class="token punctuation">:</span><span class="token punctuation">(</span>NSString <span class="token operator">*</span><span class="token punctuation">)</span>getStr
<span class="token punctuation">{</span>
    NSScanner <span class="token operator">*</span>tempScaner<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">[</span>NSScanner alloc<span class="token punctuation">]</span> initWithString<span class="token punctuation">:</span>getStr<span class="token punctuation">]</span><span class="token punctuation">;</span>
    uint32_t tempValue<span class="token punctuation">;</span>
    <span class="token punctuation">[</span>tempScaner scanHexInt<span class="token punctuation">:</span><span class="token operator">&amp;</span>tempValue<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> tempValue<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<h3 id="active-mesh-device-by-bluetooth"><a name="active-mesh-device-by-bluetooth" class="anchor-navigation-ex-anchor" href="#active-mesh-device-by-bluetooth"><i class="fa fa-link" aria-hidden="true"></i></a>1.4.3. Active Mesh Device By Bluetooth</h3>
<p>Mesh distribution networks are mainly divided into two types. One is for ordinary Bluetooth mesh devices (also called mesh sub-devices), such as lights, sockets, and low power consumption. It can be understood that as long as there is no gateway, it is an ordinary Bluetooth device. Networking for mesh gateways</p>
<p><strong>Declaration</strong></p>
<pre class="language-"><code class="lang-objective-c"><span class="token operator">-</span> <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>activeMeshDeviceIncludeGateway<span class="token punctuation">:</span><span class="token punctuation">(</span>BOOL<span class="token punctuation">)</span>includeGateway<span class="token punctuation">;</span>
</code></pre>
<p><strong>Parameters</strong></p>
<table>
<thead>
<tr>
<th>parameter</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>includeGateway</td>
<td>Whether to activate the gateway. If it is `yes&apos;, the gateway device that has been recorded in the device will be activated, and the remaining sub-devices will not be activated   Conversely activate all scanned ordinary mesh sub-devices, do not activate the gateway</td>
</tr>
</tbody>
</table>
<p><strong>Declaration</strong></p>
<pre class="language-"><code class="lang-objective-c"><span class="token comment">/**
 Activate specific devices
 */</span>
<span class="token operator">-</span> <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>activeMeshDevice<span class="token punctuation">:</span><span class="token punctuation">(</span>TYBleMeshDeviceModel <span class="token operator">*</span><span class="token punctuation">)</span>deviceModel<span class="token punctuation">;</span>
</code></pre>
<p><strong>Parameters</strong></p>
<table>
<thead>
<tr>
<th>parameter</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>deviceModel</td>
<td>model</td>
</tr>
</tbody>
</table>
<p> The distribution result will be called back through <code>TYBLEMeshManagerDelegate</code></p>
<p><strong>Declaration</strong></p>
<pre class="language-"><code class="lang-objective-c"><span class="token comment">/**
 Activate sub device callback 
 */</span>
<span class="token operator">-</span> <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>activeDeviceSuccessWithName<span class="token punctuation">:</span><span class="token punctuation">(</span>NSString <span class="token operator">*</span><span class="token punctuation">)</span>name deviceId<span class="token punctuation">:</span><span class="token punctuation">(</span>NSString <span class="token operator">*</span><span class="token punctuation">)</span>deviceId error<span class="token punctuation">:</span><span class="token punctuation">(</span>NSError <span class="token operator">*</span><span class="token punctuation">)</span>error<span class="token punctuation">;</span>
</code></pre>
<p><strong>Parameters</strong></p>
<table>
<thead>
<tr>
<th>parameter</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>name</td>
<td>device name</td>
</tr>
<tr>
<td>deviceId</td>
<td>dev Id</td>
</tr>
<tr>
<td>error</td>
<td>error</td>
</tr>
</tbody>
</table>
<p>Activate gateway device callback</p>
<p><strong>Declaration</strong></p>
<pre class="language-"><code class="lang-objective-c"><span class="token operator">-</span> <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>activeWifiDeviceWithName<span class="token punctuation">:</span><span class="token punctuation">(</span>NSString <span class="token operator">*</span><span class="token punctuation">)</span>name address<span class="token punctuation">:</span><span class="token punctuation">(</span>NSInteger<span class="token punctuation">)</span>address mac<span class="token punctuation">:</span><span class="token punctuation">(</span>NSInteger<span class="token punctuation">)</span>mac error<span class="token punctuation">:</span><span class="token punctuation">(</span>NSError <span class="token operator">*</span><span class="token punctuation">)</span>error<span class="token punctuation">;</span>
</code></pre>
<p><strong>Parameters</strong></p>
<table>
<thead>
<tr>
<th>parameter</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>name</td>
<td>device name</td>
</tr>
<tr>
<td>address</td>
<td>device address</td>
</tr>
<tr>
<td>error</td>
<td>error</td>
</tr>
</tbody>
</table>
<h3 id="active-mesh-gateway-device"><a name="active-mesh-gateway-device" class="anchor-navigation-ex-anchor" href="#active-mesh-gateway-device"><i class="fa fa-link" aria-hidden="true"></i></a>1.4.4. Active Mesh Gateway Device</h3>
<p>If the gateway device is activated, you need to configure the network with the Wi-Fi module after receiving the callback <code>activeWifiDeviceWithName</code> method. At this time, you need to call the method in <code>TuyaSmartActivator</code> to perform the operation.</p>
<h4 id="get-token"><a name="get-token" class="anchor-navigation-ex-anchor" href="#get-token"><i class="fa fa-link" aria-hidden="true"></i></a><a name="get-token" class="plugin-anchor" href="#get-token"><i class="fa fa-link" aria-hidden="true"></i></a>Get Token</h4>
<p><strong>Declaration</strong></p>
<p>mesh Wi-Fi gateway join mesh
get Token&#xFF08;10 minutes)</p>
<pre class="language-"><code class="lang-objective-c"><span class="token operator">-</span> <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>getTokenWithMeshId<span class="token punctuation">:</span><span class="token punctuation">(</span>NSString <span class="token operator">*</span><span class="token punctuation">)</span>meshI<span class="token operator">-</span> <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>getTokenWithMeshId<span class="token punctuation">:</span><span class="token punctuation">(</span>NSString <span class="token operator">*</span><span class="token punctuation">)</span>meshI&#x6211;<span class="token operator">-</span> <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>getTokenWithMeshId<span class="token punctuation">:</span><span class="token punctuation">(</span>NSString <span class="token operator">*</span><span class="token punctuation">)</span>meshI<span class="token operator">-</span> <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>getTokenWithMeshId<span class="token punctuation">:</span><span class="token punctuation">(</span>NSString <span class="token operator">*</span><span class="token punctuation">)</span>meshI&#x6211;d
                    nodeId<span class="token punctuation">:</span><span class="token punctuation">(</span>NSString <span class="token operator">*</span><span class="token punctuation">)</span>nodeId
                 productId<span class="token punctuation">:</span><span class="token punctuation">(</span>NSString <span class="token operator">*</span><span class="token punctuation">)</span>productId
                      uuid<span class="token punctuation">:</span><span class="token punctuation">(</span>NSString <span class="token operator">*</span><span class="token punctuation">)</span>uuid
                   authKey<span class="token punctuation">:</span><span class="token punctuation">(</span>NSString <span class="token operator">*</span><span class="token punctuation">)</span>authKey
                   version<span class="token punctuation">:</span><span class="token punctuation">(</span>NSString <span class="token operator">*</span><span class="token punctuation">)</span>version
                   success<span class="token punctuation">:</span><span class="token punctuation">(</span>TYSuccessString<span class="token punctuation">)</span>success
                   failure<span class="token punctuation">:</span><span class="token punctuation">(</span>TYFailureError<span class="token punctuation">)</span>failure<span class="token punctuation">;</span>
</code></pre>
<h4 id="active-gateway"><a name="active-gateway" class="anchor-navigation-ex-anchor" href="#active-gateway"><i class="fa fa-link" aria-hidden="true"></i></a><a name="active-gateway" class="plugin-anchor" href="#active-gateway"><i class="fa fa-link" aria-hidden="true"></i></a>Active Gateway</h4>
<p><strong>Declaration</strong></p>
<p>Gateway, router account, and password for gateway access</p>
<p>After activating the gateway, you can call this method after receiving the <code>activeWifiDeviceWithName</code> of <code>TYBLEMeshManagerDelegate</code></p>
<pre class="language-"><code class="lang-objective-c"><span class="token operator">-</span> <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>startBleMeshConfigWiFiWithSsid<span class="token punctuation">:</span><span class="token punctuation">(</span>NSString <span class="token operator">*</span><span class="token punctuation">)</span>ssid
                              password<span class="token punctuation">:</span><span class="token punctuation">(</span>NSString <span class="token operator">*</span><span class="token punctuation">)</span>password
                                 token<span class="token punctuation">:</span><span class="token punctuation">(</span>NSString <span class="token operator">*</span><span class="token punctuation">)</span>token
                               timeout<span class="token punctuation">:</span><span class="token punctuation">(</span>NSTimeInterval<span class="token punctuation">)</span>timeout<span class="token punctuation">;</span>
</code></pre>
<p><strong>Parameters</strong></p>
<table>
<thead>
<tr>
<th>parameter</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>ssid</td>
<td>Wi-Fi ssid</td>
</tr>
<tr>
<td>password</td>
<td>Wi-Fi password</td>
</tr>
<tr>
<td>token</td>
<td>Token</td>
</tr>
<tr>
<td>timeout</td>
<td>default 100s</td>
</tr>
</tbody>
</table>
<p><strong>Example</strong></p>
<p>Mesh sub-devices (devices without gateways) are connected to the network</p>
<pre class="language-"><code class="lang-objective-c"><span class="token comment">// 1. Activate sub device/ 1. Activate sub w</span>
<span class="token punctuation">[</span><span class="token punctuation">[</span>TYBLEMeshManager sharedInstance<span class="token punctuation">]</span> activeMeshDeviceIncludeGateway<span class="token punctuation">:</span>NO<span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token comment">// 2. TYBLEMeshManagerDelegate </span>
<span class="token operator">-</span> <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>activeDeviceSuccessWithName<span class="token punctuation">:</span><span class="token punctuation">(</span>NSString <span class="token operator">*</span><span class="token punctuation">)</span>name deviceId<span class="token punctuation">:</span><span class="token punctuation">(</span>NSString <span class="token operator">*</span><span class="token punctuation">)</span>deviceId error<span class="token punctuation">:</span><span class="token punctuation">(</span>NSError <span class="token operator">*</span><span class="token punctuation">)</span>error <span class="token punctuation">{</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">NSLog</span><span class="token punctuation">(</span><span class="token string">@&quot;error : %@&quot;</span><span class="token punctuation">,</span> error<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 3. Activation was successful. At this point, the activation of a sub device is complete.</span>
<span class="token punctuation">}</span>
</code></pre>
<pre class="language-"><code class="lang-objective-c"><span class="token comment">// 1. Activate sub device</span>
<span class="token punctuation">[</span><span class="token punctuation">[</span>TYBLEMeshManager sharedInstance<span class="token punctuation">]</span> activeMeshDeviceIncludeGateway<span class="token punctuation">:</span>NO<span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token comment">// 2. TYBLEMeshManagerDelegate </span>
<span class="token operator">-</span> <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>activeWifiDeviceWithName<span class="token punctuation">:</span><span class="token punctuation">(</span>NSString <span class="token operator">*</span><span class="token punctuation">)</span>name address<span class="token punctuation">:</span><span class="token punctuation">(</span>NSInteger<span class="token punctuation">)</span>address mac<span class="token punctuation">:</span><span class="token punctuation">(</span>NSInteger<span class="token punctuation">)</span>mac error<span class="token punctuation">:</span><span class="token punctuation">(</span>NSError <span class="token operator">*</span><span class="token punctuation">)</span>error <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
       <span class="token function">NSLog</span><span class="token punctuation">(</span><span class="token string">@&quot;error : %@&quot;</span><span class="token punctuation">,</span> error<span class="token punctuation">)</span><span class="token punctuation">;</span>
       <span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// The gateway was successfully activated. Currently, only the Bluetooth module is successful. You need to continue to configure the Wi-Fi module to activate.</span>
    <span class="token comment">// 3. The user enters the password and then reconnects, and then resends the ssid, pwd, token,</span>
    <span class="token comment">// &#xFF01;&#xFF01;&#xFF01;&#xFF01;Note that this operation must be done, otherwise it will affect the writing of Wi-Fi information and cause the distribution network to fail.</span>
    <span class="token punctuation">[</span>TYBLEMeshManager sharedInstance<span class="token punctuation">]</span><span class="token punctuation">.</span>wifiMac <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>mac<span class="token punctuation">;</span>

    <span class="token comment">// 4. get token</span>
    NSString <span class="token operator">*</span>nodeId <span class="token operator">=</span> <span class="token punctuation">[</span>NSString stringWithFormat<span class="token punctuation">:</span><span class="token string">@&quot;%02x&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>address<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">[</span><span class="token punctuation">[</span>TuyaSmartActivator sharedInstance<span class="token punctuation">]</span> getTokenWithMeshId<span class="token punctuation">:</span><span class="token punctuation">[</span>TuyaSmartUser sharedInstance<span class="token punctuation">]</span><span class="token punctuation">.</span>meshModel<span class="token punctuation">.</span>meshId
                                                 nodeId<span class="token punctuation">:</span>nodeId
                                              productId<span class="token punctuation">:</span><span class="token punctuation">[</span>TYBLEMeshManager sharedInstance<span class="token punctuation">]</span><span class="token punctuation">.</span>productId
                                                   uuid<span class="token punctuation">:</span><span class="token punctuation">[</span>TYBLEMeshManager sharedInstance<span class="token punctuation">]</span><span class="token punctuation">.</span>uuid
                                                authKey<span class="token punctuation">:</span><span class="token punctuation">[</span>TYBLEMeshManager sharedInstance<span class="token punctuation">]</span><span class="token punctuation">.</span>authKey
                                                version<span class="token punctuation">:</span><span class="token punctuation">[</span>TYBLEMeshManager sharedInstance<span class="token punctuation">]</span><span class="token punctuation">.</span>version
                                                success<span class="token punctuation">:</span><span class="token operator">^</span><span class="token punctuation">(</span>NSString <span class="token operator">*</span>token<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                                                    <span class="token comment">// 5. Set up a network distribution agent and receive activation results through the agent</span>
                                                    <span class="token punctuation">[</span>TuyaSmartActivator sharedInstance<span class="token punctuation">]</span><span class="token punctuation">.</span>delegate <span class="token operator">=</span> <span class="token keyword">self</span><span class="token punctuation">;</span>
                                                    <span class="token comment">// 6. start Wi-Fi config</span>
                                                    <span class="token punctuation">[</span><span class="token punctuation">[</span>TuyaSmartActivator sharedInstance<span class="token punctuation">]</span> startBleMeshConfigWiFiWithSsid<span class="token punctuation">:</span><span class="token string">@&quot;Wi-Fi ssid&quot;</span> password<span class="token punctuation">:</span><span class="token string">@&quot;Wi-Fi password&quot;</span> token<span class="token punctuation">:</span>token timeout<span class="token punctuation">:</span><span class="token number">100</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                                                <span class="token punctuation">}</span> failure<span class="token punctuation">:</span><span class="token operator">^</span><span class="token punctuation">(</span>NSError <span class="token operator">*</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                                                    <span class="token function">NSLog</span><span class="token punctuation">(</span><span class="token string">@&quot;error: %@&quot;</span><span class="token punctuation">,</span> error<span class="token punctuation">)</span><span class="token punctuation">;</span>
                                                <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token operator">-</span> <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>meshActivator<span class="token punctuation">:</span><span class="token punctuation">(</span>TuyaSmartActivator <span class="token operator">*</span><span class="token punctuation">)</span>activator didReceiveDeviceId<span class="token punctuation">:</span><span class="token punctuation">(</span>NSString <span class="token operator">*</span><span class="token punctuation">)</span>deviceId meshId<span class="token punctuation">:</span><span class="token punctuation">(</span>NSString <span class="token operator">*</span><span class="token punctuation">)</span>meshId error<span class="token punctuation">:</span><span class="token punctuation">(</span>NSError <span class="token operator">*</span><span class="token punctuation">)</span>error <span class="token punctuation">{</span>
      <span class="token comment">// 7. Receive activation result</span>

  <span class="token punctuation">}</span>
</code></pre>
<h4 id="mesh-connection-flag"><a name="mesh-connection-flag" class="anchor-navigation-ex-anchor" href="#mesh-connection-flag"><i class="fa fa-link" aria-hidden="true"></i></a><a name="mesh-connection-flag" class="plugin-anchor" href="#mesh-connection-flag"><i class="fa fa-link" aria-hidden="true"></i></a>Mesh Connection Flag</h4>
<p>In the process of operation, it is often judged whether the existing equipment of the mesh is connected to the network through Bluetooth to determine the method of issuing control commands and operation commands.</p>
<pre class="language-"><code class="lang-objective-c">BOOL isLogin <span class="token operator">=</span> <span class="token punctuation">[</span>TYBLEMeshManager sharedInstance<span class="token punctuation">]</span><span class="token punctuation">.</span>isLogin<span class="token punctuation">;</span>
</code></pre>
<h3 id="error-code"><a name="error-code" class="anchor-navigation-ex-anchor" href="#error-code"><i class="fa fa-link" aria-hidden="true"></i></a>1.4.5. Error Code</h3>
<table>
<thead>
<tr>
<th>Error Code</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>3088</td>
<td>Active device failed</td>
</tr>
<tr>
<td>3090</td>
<td>wrong mesh name or password</td>
</tr>
<tr>
<td>3091</td>
<td>login failed</td>
</tr>
<tr>
<td>3092</td>
<td>login decode failed</td>
</tr>
<tr>
<td>3093</td>
<td>fetch auth key failed</td>
</tr>
<tr>
<td>3094</td>
<td>address beyond limit</td>
</tr>
<tr>
<td>3095</td>
<td>update address failed</td>
</tr>
<tr>
<td>3096</td>
<td>input mesh description failed</td>
</tr>
<tr>
<td>3097</td>
<td>mesh description is empty</td>
</tr>
<tr>
<td>3098</td>
<td>device has out in mesh</td>
</tr>
<tr>
<td>3099</td>
<td>write failed</td>
</tr>
<tr>
<td>4000</td>
<td>wrong Wi-Fi decription</td>
</tr>
<tr>
<td>4001</td>
<td>wrong Wi-Fi token</td>
</tr>
<tr>
<td>4010</td>
<td>login timeout</td>
</tr>
<tr>
<td>4011</td>
<td>fetch auth key timeout</td>
</tr>
<tr>
<td>4012</td>
<td>update address timeout</td>
</tr>
<tr>
<td>4013</td>
<td>input mesh description timeout</td>
</tr>
<tr>
<td>4014</td>
<td>input Wi-Fi description timeout</td>
</tr>
</tbody>
</table>
<h2 id="device"><a name="device" class="anchor-navigation-ex-anchor" href="#device"><i class="fa fa-link" aria-hidden="true"></i></a>1.5. Device</h2>
<blockquote>
<p>Like the Home SDK, the device class is TuyaSmartDevice. The deviceType information in TuyaSmartDeviceModel inside can distinguish the device type.</p>
<p>Here the mesh device corresponds to the deviceType type TuyaSmartDeviceModelTypeMeshBleSubDev</p>
</blockquote>
<h3 id="rename-device"><a name="rename-device" class="anchor-navigation-ex-anchor" href="#rename-device"><i class="fa fa-link" aria-hidden="true"></i></a>1.5.1. Rename Device</h3>
<p><strong>Declaration</strong></p>
<pre class="language-"><code class="lang-objective-c"><span class="token operator">-</span> <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>renameMeshSubDeviceWithDeviceId<span class="token punctuation">:</span><span class="token punctuation">(</span>NSString <span class="token operator">*</span><span class="token punctuation">)</span>deviceId name<span class="token punctuation">:</span><span class="token punctuation">(</span>NSString <span class="token operator">*</span><span class="token punctuation">)</span>name success<span class="token punctuation">:</span><span class="token punctuation">(</span>TYSuccessHandler<span class="token punctuation">)</span>success failure<span class="token punctuation">:</span><span class="token punctuation">(</span>TYFailureError<span class="token punctuation">)</span>failure<span class="token punctuation">;</span>
</code></pre>
<p><strong>Parameters</strong></p>
<table>
<thead>
<tr>
<th>parameter</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>deviceId</td>
<td>dev id</td>
</tr>
<tr>
<td>name</td>
<td>new name</td>
</tr>
<tr>
<td>success</td>
<td>success block</td>
</tr>
<tr>
<td>failure</td>
<td>failure block</td>
</tr>
</tbody>
</table>
<p><strong>Example</strong></p>
<pre class="language-"><code class="lang-objective-c"><span class="token punctuation">[</span><span class="token punctuation">[</span>TuyaSmartUser sharedInstance<span class="token punctuation">]</span><span class="token punctuation">.</span>mesh renameMeshSubDeviceWithDeviceId<span class="token punctuation">:</span><span class="token keyword">self</span><span class="token punctuation">.</span>device<span class="token punctuation">.</span>devId name<span class="token punctuation">:</span>name success<span class="token punctuation">:</span><span class="token operator">^</span><span class="token punctuation">{</span>
            <span class="token comment">// success do</span>
        <span class="token punctuation">}</span> failure<span class="token punctuation">:</span><span class="token operator">^</span><span class="token punctuation">(</span>NSError <span class="token operator">*</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// failure do</span>
        <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre>
<h3 id="local-connection-and-gateway-connection"><a name="local-connection-and-gateway-connection" class="anchor-navigation-ex-anchor" href="#local-connection-and-gateway-connection"><i class="fa fa-link" aria-hidden="true"></i></a>1.5.2. Local Connection and Gateway Connection</h3>
<p><strong>Local connection</strong></p>
<p>The Bluetooth of the mobile phone is turned on and the mesh device is controlled by Bluetooth.</p>
<p> <code>deviceModel.isOnline &amp;&amp; deviceModel.isMeshBleOnline</code></p>
<p><strong>Gateway connection</strong></p>
<p>The mobile phone&apos;s Bluetooth is not turned on or is far away from the device. The mesh device controls the connection through the gateway and issues commands by Wi-Fi.</p>
<p> <code>deviceModel.isOnline &amp;&amp; !deviceModel.isMeshBleOnline</code></p>
<h3 id="remove-device"><a name="remove-device" class="anchor-navigation-ex-anchor" href="#remove-device"><i class="fa fa-link" aria-hidden="true"></i></a>1.5.3. Remove Device</h3>
<p>Remove device requires cloud delete, local delete</p>
<h4 id="local-remove"><a name="local-remove" class="anchor-navigation-ex-anchor" href="#local-remove"><i class="fa fa-link" aria-hidden="true"></i></a><a name="local-remove" class="plugin-anchor" href="#local-remove"><i class="fa fa-link" aria-hidden="true"></i></a>Local Remove</h4>
<p><strong>Declaration</strong></p>
<pre class="language-"><code class="lang-objective-c"><span class="token comment">// use ble</span>
<span class="token operator">-</span> <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>kickoutLightWithAddress<span class="token punctuation">:</span><span class="token punctuation">(</span>uint32_t<span class="token punctuation">)</span>address type<span class="token punctuation">:</span><span class="token punctuation">(</span>NSString <span class="token operator">*</span><span class="token punctuation">)</span>type<span class="token punctuation">;</span>

<span class="token comment">// use gateway</span>
<span class="token operator">-</span> <span class="token punctuation">(</span>NSString <span class="token operator">*</span><span class="token punctuation">)</span>rawDataKickoutLightWithAddress<span class="token punctuation">:</span><span class="token punctuation">(</span>uint32_t<span class="token punctuation">)</span>address type<span class="token punctuation">:</span><span class="token punctuation">(</span>NSString <span class="token operator">*</span><span class="token punctuation">)</span>type<span class="token punctuation">;</span>

<span class="token operator">-</span> <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>publishRawDataWithRaw<span class="token punctuation">:</span><span class="token punctuation">(</span>NSString <span class="token operator">*</span><span class="token punctuation">)</span>raw
                          pcc<span class="token punctuation">:</span><span class="token punctuation">(</span>NSString <span class="token operator">*</span><span class="token punctuation">)</span>pcc
                      success<span class="token punctuation">:</span><span class="token punctuation">(</span>TYSuccessHandler<span class="token punctuation">)</span>success
                      failure<span class="token punctuation">:</span><span class="token punctuation">(</span>TYFailureError<span class="token punctuation">)</span>failure<span class="token punctuation">;</span>
</code></pre>
<h4 id="remote-remove"><a name="remote-remove" class="anchor-navigation-ex-anchor" href="#remote-remove"><i class="fa fa-link" aria-hidden="true"></i></a><a name="remote-remove" class="plugin-anchor" href="#remote-remove"><i class="fa fa-link" aria-hidden="true"></i></a>Remote Remove</h4>
<p><strong>Declaration</strong></p>
<pre class="language-"><code class="lang-objective-c"><span class="token operator">-</span> <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>removeMeshSubDeviceWithDeviceId<span class="token punctuation">:</span><span class="token punctuation">(</span>NSString <span class="token operator">*</span><span class="token punctuation">)</span>deviceId success<span class="token punctuation">:</span><span class="token punctuation">(</span>TYSuccessHandler<span class="token punctuation">)</span>success failure<span class="token punctuation">:</span><span class="token punctuation">(</span>TYFailureError<span class="token punctuation">)</span>failure<span class="token punctuation">;</span>
</code></pre>
<p><strong>Example</strong></p>
<pre class="language-"><code class="lang-objective-c"> <span class="token keyword">int</span> address <span class="token operator">=</span> <span class="token punctuation">[</span>smartDevice<span class="token punctuation">.</span>deviceModel<span class="token punctuation">.</span>nodeId intValue<span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token number">8</span><span class="token punctuation">;</span>

        <span class="token comment">// 1.  remote remove</span>
        <span class="token punctuation">[</span><span class="token punctuation">[</span>TuyaSmartUser sharedInstance<span class="token punctuation">]</span><span class="token punctuation">.</span>mesh removeMeshSubDeviceWithDeviceId<span class="token punctuation">:</span><span class="token punctuation">[</span>smartDevice<span class="token punctuation">.</span>deviceModel<span class="token punctuation">.</span>devId success<span class="token punctuation">:</span><span class="token operator">^</span><span class="token punctuation">{</span>

        <span class="token punctuation">}</span> failure<span class="token punctuation">:</span><span class="token operator">^</span><span class="token punctuation">(</span>NSError <span class="token operator">*</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

        <span class="token comment">// 2. local remove</span>
        <span class="token comment">// Judge the connection, use gateway or Bluetooth</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">[</span>TYBLEMeshManager sharedInstance<span class="token punctuation">]</span><span class="token punctuation">.</span>isLogin<span class="token punctuation">)</span> <span class="token punctuation">{</span>

            <span class="token punctuation">[</span><span class="token punctuation">[</span>TYBLEMeshManager sharedInstance<span class="token punctuation">]</span> kickoutLightWithAddress<span class="token punctuation">:</span>address type<span class="token punctuation">:</span><span class="token punctuation">[</span>smartDevice<span class="token punctuation">.</span>deviceModel<span class="token punctuation">.</span>pcc<span class="token punctuation">]</span><span class="token punctuation">;</span>

        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>

            <span class="token punctuation">[</span><span class="token punctuation">[</span>TuyaSmartUser sharedInstance<span class="token punctuation">]</span><span class="token punctuation">.</span>mesh publishRawDataWithRaw<span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token punctuation">[</span>TYBLEMeshManager sharedInstance<span class="token punctuation">]</span> rawDataKickoutLightWithAddress<span class="token punctuation">:</span>address type<span class="token punctuation">:</span><span class="token punctuation">[</span>smartDevice<span class="token punctuation">.</span>deviceModel<span class="token punctuation">.</span>pcc<span class="token punctuation">]</span> pcc<span class="token punctuation">:</span><span class="token punctuation">[</span>smartDevice<span class="token punctuation">.</span>deviceModel<span class="token punctuation">.</span>pcc success<span class="token punctuation">:</span><span class="token operator">^</span><span class="token punctuation">{</span>

            <span class="token punctuation">}</span> failure<span class="token punctuation">:</span><span class="token operator">^</span><span class="token punctuation">(</span>NSError <span class="token operator">*</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>

            <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
</code></pre>
<h3 id="query-mesh-device-status"><a name="query-mesh-device-status" class="anchor-navigation-ex-anchor" href="#query-mesh-device-status"><i class="fa fa-link" aria-hidden="true"></i></a>1.5.4. Query Mesh Device Status</h3>
<pre class="language-"><code class="lang-objective-c"><span class="token operator">-</span> <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>getDeviceStatusAllWithAddress<span class="token punctuation">:</span><span class="token punctuation">(</span>uint32_t<span class="token punctuation">)</span>address
                                 type<span class="token punctuation">:</span><span class="token punctuation">(</span>NSString <span class="token operator">*</span><span class="token punctuation">)</span>type<span class="token punctuation">;</span>
</code></pre>
<p><strong>Parameters</strong></p>
<table>
<thead>
<tr>
<th>parameter</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>address</td>
<td>mesh device address</td>
</tr>
<tr>
<td>type</td>
<td>type</td>
</tr>
</tbody>
</table>
<h2 id="group"><a name="group" class="anchor-navigation-ex-anchor" href="#group"><i class="fa fa-link" aria-hidden="true"></i></a>1.6. Group</h2>
<p>A group is one of the features of a mesh. After adding devices to the group, you can control all the devices in the group with one command.</p>
<h3 id="create-group"><a name="create-group" class="anchor-navigation-ex-anchor" href="#create-group"><i class="fa fa-link" aria-hidden="true"></i></a>1.6.1. Create Group</h3>
<blockquote>
<p>When creating the group address, the local Id starts from 0x8001, and is superimposed in order.</p>
<p>The size of the group is the same as that of the device. Incoming means that this group agrees that such devices are organized into a group.</p>
<p>Note: If other categories are forcibly added, control may fail due to different dp</p>
</blockquote>
<p>Currently, each mesh supports a maximum of 255 groups, and a device can only join a maximum of 8 groups.</p>
<p><strong>Declaration</strong></p>
<pre class="language-"><code class="lang-objective-c"><span class="token operator">+</span> <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>createMeshGroupWithGroupName<span class="token punctuation">:</span><span class="token punctuation">(</span>NSString <span class="token operator">*</span><span class="token punctuation">)</span>groupName
                              meshId<span class="token punctuation">:</span><span class="token punctuation">(</span>NSString <span class="token operator">*</span><span class="token punctuation">)</span>meshId
                             localId<span class="token punctuation">:</span><span class="token punctuation">(</span>NSString <span class="token operator">*</span><span class="token punctuation">)</span>localId
                                 pcc<span class="token punctuation">:</span><span class="token punctuation">(</span>NSString <span class="token operator">*</span><span class="token punctuation">)</span>pcc
                             success<span class="token punctuation">:</span><span class="token punctuation">(</span>TYSuccessInt<span class="token punctuation">)</span>success
                             failure<span class="token punctuation">:</span><span class="token punctuation">(</span>TYFailureError<span class="token punctuation">)</span>failure<span class="token punctuation">;</span>
</code></pre>
<p><strong>Parameters</strong></p>
<table>
<thead>
<tr>
<th>parameter</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>groupName</td>
<td>group name</td>
</tr>
<tr>
<td>meshId</td>
<td>meshId</td>
</tr>
<tr>
<td>localId</td>
<td>group address</td>
</tr>
<tr>
<td>pcc</td>
<td>pcc</td>
</tr>
<tr>
<td>success</td>
<td>success block</td>
</tr>
<tr>
<td>failure</td>
<td>failure block</td>
</tr>
</tbody>
</table>
<p><strong>Example</strong></p>
<pre class="language-"><code class="lang-objective-c">
NSInteger localId <span class="token operator">=</span> <span class="token number">0x8001</span><span class="token punctuation">;</span>
<span class="token punctuation">[</span>TuyaSmartBleMeshGroup createMeshGroupWithGroupName<span class="token punctuation">:</span><span class="token operator">@</span><span class="token operator">&lt;</span>group name<span class="token operator">&gt;</span> meshId<span class="token punctuation">:</span><span class="token punctuation">[</span>TuyaSmartUser sharedInstance<span class="token punctuation">]</span><span class="token punctuation">.</span>meshModel<span class="token punctuation">.</span>meshId localId<span class="token punctuation">:</span><span class="token punctuation">[</span>NSString stringWithFormat<span class="token punctuation">:</span><span class="token string">@&quot;%lx&quot;</span><span class="token punctuation">,</span> localId<span class="token punctuation">]</span> pcc<span class="token punctuation">:</span>#<span class="token operator">&lt;</span>pcc<span class="token operator">&gt;</span> success<span class="token punctuation">:</span><span class="token operator">^</span><span class="token punctuation">(</span><span class="token keyword">int</span> result<span class="token punctuation">)</span> <span class="token punctuation">{</span>
     <span class="token comment">// success do</span>
     <span class="token keyword">self</span><span class="token punctuation">.</span>meshGroup <span class="token operator">=</span> <span class="token punctuation">[</span>TuyaSmartBleMeshGroup meshGroupWithGroupId<span class="token punctuation">:</span>result<span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token punctuation">}</span> failure<span class="token punctuation">:</span><span class="token operator">^</span><span class="token punctuation">(</span>NSError <span class="token operator">*</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
       <span class="token comment">// failure do</span>
    <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre>
<h3 id="add-device-to-group"><a name="add-device-to-group" class="anchor-navigation-ex-anchor" href="#add-device-to-group"><i class="fa fa-link" aria-hidden="true"></i></a>1.6.2. Add Device to Group</h3>
<blockquote>
<p>Adding a device to a group requires local and cloud double verification before it can be counted as a device successfully joining the group. Results</p>
<p>Operations are performed one by one by the device and performed sequentially. Not concurrent</p>
</blockquote>
<p>Local add</p>
<pre class="language-"><code class="lang-objective-c"><span class="token comment">// Local connection</span>
<span class="token operator">-</span> <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>addDeviceAddress<span class="token punctuation">:</span><span class="token punctuation">(</span>uint32_t<span class="token punctuation">)</span>deviceAddress type<span class="token punctuation">:</span><span class="token punctuation">(</span>NSString <span class="token operator">*</span><span class="token punctuation">)</span>type groupAddress<span class="token punctuation">:</span><span class="token punctuation">(</span>uint32_t<span class="token punctuation">)</span>groupAddress<span class="token punctuation">;</span>

<span class="token comment">// TYBLEMeshManagerDelegate</span>
<span class="token operator">-</span> <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>deviceAddGroupAddress<span class="token punctuation">:</span><span class="token punctuation">(</span>uint32_t<span class="token punctuation">)</span>address error<span class="token punctuation">:</span><span class="token punctuation">(</span>NSError <span class="token operator">*</span><span class="token punctuation">)</span>error<span class="token punctuation">;</span>



<span class="token comment">// Gateway connection</span>

<span class="token operator">-</span> <span class="token punctuation">(</span>NSString <span class="token operator">*</span><span class="token punctuation">)</span>rawDataAddDeviceAddress<span class="token punctuation">:</span><span class="token punctuation">(</span>uint32_t<span class="token punctuation">)</span>deviceAddress groupAddress<span class="token punctuation">:</span><span class="token punctuation">(</span>uint32_t<span class="token punctuation">)</span>groupAddress type<span class="token punctuation">:</span><span class="token punctuation">(</span>NSString <span class="token operator">*</span><span class="token punctuation">)</span>type<span class="token punctuation">;</span>

<span class="token operator">-</span> <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>publishRawDataWithRaw<span class="token punctuation">:</span><span class="token punctuation">(</span>NSString <span class="token operator">*</span><span class="token punctuation">)</span>raw
                          pcc<span class="token punctuation">:</span><span class="token punctuation">(</span>NSString <span class="token operator">*</span><span class="token punctuation">)</span>pcc
                      success<span class="token punctuation">:</span><span class="token punctuation">(</span>TYSuccessHandler<span class="token punctuation">)</span>success
                      failure<span class="token punctuation">:</span><span class="token punctuation">(</span>TYFailureError<span class="token punctuation">)</span>failure<span class="token punctuation">;</span>

<span class="token comment">// TuyaSmartBleMeshDelegate </span>
<span class="token operator">-</span> <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>bleMeshReceiveRawData<span class="token punctuation">:</span><span class="token punctuation">(</span>NSString <span class="token operator">*</span><span class="token punctuation">)</span>raw<span class="token punctuation">;</span>
</code></pre>
<p>Remote add</p>
<p><strong>Declaration</strong></p>
<p>After the above verification is completed, you can use this method to record the operation to the cloud and then proceed to the next device operation</p>
<pre class="language-"><code class="lang-objective-c"><span class="token operator">-</span> <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>addDeviceWithDeviceId<span class="token punctuation">:</span><span class="token punctuation">(</span>NSString <span class="token operator">*</span><span class="token punctuation">)</span>deviceId success<span class="token punctuation">:</span><span class="token punctuation">(</span>TYSuccessHandler<span class="token punctuation">)</span>success failure<span class="token punctuation">:</span><span class="token punctuation">(</span>TYFailureError<span class="token punctuation">)</span>failure<span class="token punctuation">;</span>
</code></pre>
<p><strong>Parameters</strong></p>
<table>
<thead>
<tr>
<th>parameter</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>success</td>
<td>success block</td>
</tr>
<tr>
<td>failure</td>
<td>failure block</td>
</tr>
</tbody>
</table>
<p><strong>Example</strong></p>
<pre class="language-"><code class="lang-objective-c"><span class="token operator">-</span> <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>addDeviceToGroup<span class="token punctuation">:</span><span class="token punctuation">(</span>TuyaSmartDeviceModel <span class="token operator">*</span><span class="token punctuation">)</span>model <span class="token punctuation">{</span>
        <span class="token keyword">int</span> nodeId <span class="token operator">=</span> <span class="token punctuation">[</span>model<span class="token punctuation">.</span>nodeId intValue<span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token number">8</span><span class="token punctuation">;</span>
        <span class="token comment">// ...</span>
        _address <span class="token operator">=</span> nodeId <span class="token operator">&gt;&gt;</span> <span class="token number">8</span><span class="token punctuation">;</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">[</span>TYBLEMeshManager sharedInstance<span class="token punctuation">]</span><span class="token punctuation">.</span>isLogin<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// ble</span>
            <span class="token punctuation">[</span><span class="token punctuation">[</span>TYBLEMeshManager sharedInstance<span class="token punctuation">]</span> addDeviceAddress<span class="token punctuation">:</span>nodeId type<span class="token punctuation">:</span><span class="token keyword">self</span><span class="token punctuation">.</span>meshGroup<span class="token punctuation">.</span>meshGroupModel<span class="token punctuation">.</span>pcc groupAddress<span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token keyword">self</span><span class="token punctuation">.</span>meshGroup<span class="token punctuation">.</span>meshGroupModel<span class="token punctuation">.</span>localId intValue<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token comment">// Wi-Fi</span>
            <span class="token punctuation">[</span><span class="token punctuation">[</span>TuyaSmartUser sharedInstance<span class="token punctuation">]</span><span class="token punctuation">.</span>mesh publishRawDataWithRaw<span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token punctuation">[</span>TYBLEMeshManager sharedInstance<span class="token punctuation">]</span> rawDataAddDeviceAddress<span class="token punctuation">:</span>nodeId groupAddress<span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token keyword">self</span><span class="token punctuation">.</span>meshGroup<span class="token punctuation">.</span>meshGroupModel<span class="token punctuation">.</span>localId intValue<span class="token punctuation">]</span> type<span class="token punctuation">:</span><span class="token keyword">self</span><span class="token punctuation">.</span>meshGroup<span class="token punctuation">.</span>meshGroupModel<span class="token punctuation">.</span>pcc<span class="token punctuation">]</span> pcc<span class="token punctuation">:</span><span class="token keyword">self</span><span class="token punctuation">.</span>meshGroup<span class="token punctuation">.</span>meshGroupModel<span class="token punctuation">.</span>pcc success<span class="token punctuation">:</span><span class="token operator">^</span><span class="token punctuation">{</span>
            <span class="token punctuation">}</span> failure<span class="token punctuation">:</span><span class="token operator">^</span><span class="token punctuation">(</span>NSError <span class="token operator">*</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// add flag</span>
        _isAdd <span class="token operator">=</span> YES<span class="token punctuation">;</span>

    <span class="token comment">// Here you can do the timeout yourself. It is recommended to fail if it is not received within 5s, and execute the next one.</span>
<span class="token punctuation">}</span>


<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">pragma</span> <span class="token expression">mark <span class="token operator">-</span> TYBLEMeshManagerDelegate</span></span>
<span class="token operator">-</span> <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>deviceAddGroupAddress<span class="token punctuation">:</span><span class="token punctuation">(</span>uint32_t<span class="token punctuation">)</span>address<span class="token punctuation">;</span> <span class="token punctuation">{</span>
    <span class="token function">NSLog</span><span class="token punctuation">(</span><span class="token string">@&quot; --- deviceAddGroupAddress %d &quot;</span><span class="token punctuation">,</span> address<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>_address <span class="token operator">==</span> address<span class="token punctuation">)</span> <span class="token punctuation">{</span>

            <span class="token punctuation">[</span><span class="token keyword">self</span><span class="token punctuation">.</span>meshGroup addDeviceWithDeviceId<span class="token punctuation">:</span>_devId success<span class="token punctuation">:</span><span class="token operator">^</span><span class="token punctuation">{</span>
                <span class="token comment">// success, next</span>
            <span class="token punctuation">}</span> failure<span class="token punctuation">:</span><span class="token operator">^</span><span class="token punctuation">(</span>NSError <span class="token operator">*</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>

            <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>


<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">pragma</span> <span class="token expression">mark <span class="token operator">-</span> TuyaSmartBleMeshDelegate</span></span>

<span class="token comment">// This method will be triggered under the gateway connection </span>
<span class="token operator">-</span> <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>bleMeshReceiveRawData<span class="token punctuation">:</span><span class="token punctuation">(</span>NSString <span class="token operator">*</span><span class="token punctuation">)</span>raw <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span>raw substringWithRange<span class="token punctuation">:</span><span class="token function">NSMakeRange</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">]</span> isEqualToString<span class="token punctuation">:</span><span class="token string">@&quot;d4&quot;</span><span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> _address <span class="token operator">==</span> <span class="token punctuation">[</span>TPUtils getIntValueByHex<span class="token punctuation">:</span><span class="token punctuation">[</span>raw substringWithRange<span class="token punctuation">:</span><span class="token function">NSMakeRange</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>raw<span class="token punctuation">.</span>length <span class="token operator">&lt;</span> <span class="token number">14</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">NSLog</span><span class="token punctuation">(</span><span class="token string">@&quot;raw error&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        BOOL isNewProtocol <span class="token operator">=</span> <span class="token punctuation">[</span>TPUtils getIntValueByHex<span class="token punctuation">:</span><span class="token punctuation">[</span>raw substringWithRange<span class="token punctuation">:</span><span class="token function">NSMakeRange</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">255</span><span class="token punctuation">;</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>isNewProtocol<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">int</span> state <span class="token operator">=</span> <span class="token punctuation">[</span>TPUtils getIntValueByHex<span class="token punctuation">:</span><span class="token punctuation">[</span>raw substringWithRange<span class="token punctuation">:</span><span class="token function">NSMakeRange</span><span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

            <span class="token keyword">if</span> <span class="token punctuation">(</span>state <span class="token operator">==</span> <span class="token number">1</span> <span class="token operator">||</span> state <span class="token operator">==</span> <span class="token number">255</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token function">NSLog</span><span class="token punctuation">(</span><span class="token string">@&quot;success&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                   <span class="token comment">// next</span>
                <span class="token keyword">return</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

        <span class="token punctuation">}</span>

            <span class="token punctuation">[</span><span class="token keyword">self</span><span class="token punctuation">.</span>meshGroup addDeviceWithDeviceId<span class="token punctuation">:</span>_devId success<span class="token punctuation">:</span><span class="token operator">^</span><span class="token punctuation">{</span>
                <span class="token comment">// next</span>
            <span class="token punctuation">}</span> failure<span class="token punctuation">:</span><span class="token operator">^</span><span class="token punctuation">(</span>NSError <span class="token operator">*</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<h3 id="remove-device-from-group"><a name="remove-device-from-group" class="anchor-navigation-ex-anchor" href="#remove-device-from-group"><i class="fa fa-link" aria-hidden="true"></i></a>1.6.3. Remove Device From Group</h3>
<p><strong>Declaration</strong></p>
<p>Bluetooth</p>
<pre class="language-"><code class="lang-objective-c"><span class="token operator">-</span> <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>deleteDeviceAddress<span class="token punctuation">:</span><span class="token punctuation">(</span>uint32_t<span class="token punctuation">)</span>deviceAddress type<span class="token punctuation">:</span><span class="token punctuation">(</span>NSString <span class="token operator">*</span><span class="token punctuation">)</span>type groupAddress<span class="token punctuation">:</span><span class="token punctuation">(</span>uint32_t<span class="token punctuation">)</span>groupAddress<span class="token punctuation">;</span>

<span class="token comment">// TYBLEMeshManagerDelegate callback</span>
<span class="token operator">-</span> <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>deviceAddGroupAddress<span class="token punctuation">:</span><span class="token punctuation">(</span>uint32_t<span class="token punctuation">)</span>address error<span class="token punctuation">:</span><span class="token punctuation">(</span>NSError <span class="token operator">*</span><span class="token punctuation">)</span>error<span class="token punctuation">;</span>
</code></pre>
<p><strong>Declaration</strong></p>
<p>Gateway</p>
<pre class="language-"><code class="lang-objective-c"><span class="token operator">-</span> <span class="token punctuation">(</span>NSString <span class="token operator">*</span><span class="token punctuation">)</span>rawDataDeleteDeviceAddress<span class="token punctuation">:</span><span class="token punctuation">(</span>uint32_t<span class="token punctuation">)</span>deviceAddress groupAddress<span class="token punctuation">:</span><span class="token punctuation">(</span>uint32_t<span class="token punctuation">)</span>groupAddress type<span class="token punctuation">:</span><span class="token punctuation">(</span>NSString <span class="token operator">*</span><span class="token punctuation">)</span>type

<span class="token operator">-</span> <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>publishRawDataWithRaw<span class="token punctuation">:</span><span class="token punctuation">(</span>NSString <span class="token operator">*</span><span class="token punctuation">)</span>raw
                          pcc<span class="token punctuation">:</span><span class="token punctuation">(</span>NSString <span class="token operator">*</span><span class="token punctuation">)</span>pcc
                      success<span class="token punctuation">:</span><span class="token punctuation">(</span>TYSuccessHandler<span class="token punctuation">)</span>success
                      failure<span class="token punctuation">:</span><span class="token punctuation">(</span>TYFailureError<span class="token punctuation">)</span>failure<span class="token punctuation">;</span>

<span class="token comment">// `TuyaSmartBleMeshDelegate` - (void)bleMeshReceiveRawData:(NSString *)raw callback</span>
<span class="token comment">// TuyaSmartBleMeshDelegate </span>
<span class="token operator">-</span> <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>bleMeshReceiveRawData<span class="token punctuation">:</span><span class="token punctuation">(</span>NSString <span class="token operator">*</span><span class="token punctuation">)</span>raw<span class="token punctuation">;</span>
</code></pre>
<p><strong>Declaration</strong></p>
<p>Remote delete</p>
<p>After the above verification is completed, you can use this method to record the operation to the cloud and then proceed to the next device operation</p>
<pre class="language-"><code class="lang-objective-c"><span class="token operator">-</span> <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>removeDeviceWithDeviceId<span class="token punctuation">:</span><span class="token punctuation">(</span>NSString <span class="token operator">*</span><span class="token punctuation">)</span>deviceId success<span class="token punctuation">:</span><span class="token punctuation">(</span>TYSuccessHandler<span class="token punctuation">)</span>success failure<span class="token punctuation">:</span><span class="token punctuation">(</span>TYFailureError<span class="token punctuation">)</span>failure<span class="token punctuation">;</span>
</code></pre>
<p><strong>Example</strong></p>
<pre class="language-"><code class="lang-objective-c"><span class="token operator">-</span> <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>deleteDeviceFromGroup<span class="token punctuation">:</span><span class="token punctuation">(</span>TuyaSmartDeviceModel <span class="token operator">*</span><span class="token punctuation">)</span>model <span class="token punctuation">{</span>

        <span class="token keyword">int</span> nodeId <span class="token operator">=</span> <span class="token punctuation">[</span>model<span class="token punctuation">.</span>nodeId intValue<span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token number">8</span><span class="token punctuation">;</span>

        <span class="token comment">// Record the device address of the current operation for subsequent callback judgment</span>
        _address <span class="token operator">=</span> nodeId <span class="token operator">&gt;&gt;</span> <span class="token number">8</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">[</span>TYBLEMeshManager sharedInstance<span class="token punctuation">]</span><span class="token punctuation">.</span>isLogin<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// ble</span>
            <span class="token punctuation">[</span><span class="token punctuation">[</span>TYBLEMeshManager sharedInstance<span class="token punctuation">]</span> deleteDeviceAddress<span class="token punctuation">:</span>nodeId type<span class="token punctuation">:</span><span class="token keyword">self</span><span class="token punctuation">.</span>meshGroup<span class="token punctuation">.</span>meshGroupModel<span class="token punctuation">.</span>pcc groupAddress<span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token keyword">self</span><span class="token punctuation">.</span>meshGroup<span class="token punctuation">.</span>meshGroupModel<span class="token punctuation">.</span>localId intValue<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token comment">// wifi</span>
            <span class="token punctuation">[</span><span class="token punctuation">[</span>TuyaSmartUser sharedInstance<span class="token punctuation">]</span><span class="token punctuation">.</span>mesh publishRawDataWithRaw<span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token punctuation">[</span>TYBLEMeshManager sharedInstance<span class="token punctuation">]</span> rawDataDeleteDeviceAddress<span class="token punctuation">:</span>nodeId groupAddress<span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token keyword">self</span><span class="token punctuation">.</span>meshGroup<span class="token punctuation">.</span>meshGroupModel<span class="token punctuation">.</span>localId intValue<span class="token punctuation">]</span> type<span class="token punctuation">:</span><span class="token keyword">self</span><span class="token punctuation">.</span>meshGroup<span class="token punctuation">.</span>meshGroupModel<span class="token punctuation">.</span>pcc<span class="token punctuation">]</span> pcc<span class="token punctuation">:</span><span class="token keyword">self</span><span class="token punctuation">.</span>meshGroup<span class="token punctuation">.</span>meshGroupModel<span class="token punctuation">.</span>pcc success<span class="token punctuation">:</span><span class="token operator">^</span><span class="token punctuation">{</span>
            <span class="token punctuation">}</span> failure<span class="token punctuation">:</span><span class="token operator">^</span><span class="token punctuation">(</span>NSError <span class="token operator">*</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// delete flag</span>
        _isAdd <span class="token operator">=</span> NO<span class="token punctuation">;</span>

  <span class="token comment">//Here you can do the timeout yourself. It is recommended to fail if it is not received within 5s, and execute the next one.</span>
<span class="token punctuation">}</span>


<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">pragma</span> <span class="token expression">mark <span class="token operator">-</span> TYBLEMeshManagerDelegate</span></span>
<span class="token operator">-</span> <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>deviceAddGroupAddress<span class="token punctuation">:</span><span class="token punctuation">(</span>uint32_t<span class="token punctuation">)</span>address<span class="token punctuation">;</span> <span class="token punctuation">{</span>
    <span class="token function">NSLog</span><span class="token punctuation">(</span><span class="token string">@&quot; --- deviceAddGroupAddress %d &quot;</span><span class="token punctuation">,</span> address<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>_address <span class="token operator">==</span> address<span class="token punctuation">)</span> <span class="token punctuation">{</span>

            <span class="token punctuation">[</span><span class="token keyword">self</span><span class="token punctuation">.</span>meshGroup removeDeviceWithDeviceId<span class="token punctuation">:</span>_devId success<span class="token punctuation">:</span><span class="token operator">^</span><span class="token punctuation">{</span>
                <span class="token comment">//  success next</span>
            <span class="token punctuation">}</span> failure<span class="token punctuation">:</span><span class="token operator">^</span><span class="token punctuation">(</span>NSError <span class="token operator">*</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>


<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">pragma</span> <span class="token expression">mark <span class="token operator">-</span> TuyaSmartBleMeshDelegate</span></span>

<span class="token comment">// This method will be triggered under the gateway connection </span>
<span class="token operator">-</span> <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>bleMeshReceiveRawData<span class="token punctuation">:</span><span class="token punctuation">(</span>NSString <span class="token operator">*</span><span class="token punctuation">)</span>raw <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span>raw substringWithRange<span class="token punctuation">:</span><span class="token function">NSMakeRange</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">]</span> isEqualToString<span class="token punctuation">:</span><span class="token string">@&quot;d4&quot;</span><span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> _address <span class="token operator">==</span> <span class="token punctuation">[</span>TPUtils getIntValueByHex<span class="token punctuation">:</span><span class="token punctuation">[</span>raw substringWithRange<span class="token punctuation">:</span><span class="token function">NSMakeRange</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>raw<span class="token punctuation">.</span>length <span class="token operator">&lt;</span> <span class="token number">14</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">NSLog</span><span class="token punctuation">(</span><span class="token string">@&quot;raw error&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        BOOL isNewProtocol <span class="token operator">=</span> <span class="token punctuation">[</span>TPUtils getIntValueByHex<span class="token punctuation">:</span><span class="token punctuation">[</span>raw substringWithRange<span class="token punctuation">:</span><span class="token function">NSMakeRange</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">255</span><span class="token punctuation">;</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>isNewProtocol<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">int</span> state <span class="token operator">=</span> <span class="token punctuation">[</span>TPUtils getIntValueByHex<span class="token punctuation">:</span><span class="token punctuation">[</span>raw substringWithRange<span class="token punctuation">:</span><span class="token function">NSMakeRange</span><span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

            <span class="token keyword">if</span> <span class="token punctuation">(</span>state <span class="token operator">==</span> <span class="token number">1</span> <span class="token operator">||</span> state <span class="token operator">==</span> <span class="token number">255</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token function">NSLog</span><span class="token punctuation">(</span><span class="token string">@&quot;success&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                   <span class="token comment">// next</span>
                <span class="token keyword">return</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

        <span class="token punctuation">}</span>

            <span class="token punctuation">[</span><span class="token keyword">self</span><span class="token punctuation">.</span>meshGroup removeDeviceWithDeviceId<span class="token punctuation">:</span>_devId success<span class="token punctuation">:</span><span class="token operator">^</span><span class="token punctuation">{</span>
                <span class="token comment">// success next </span>
            <span class="token punctuation">}</span> failure<span class="token punctuation">:</span><span class="token operator">^</span><span class="token punctuation">(</span>NSError <span class="token operator">*</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<h3 id="get-group-instance"><a name="get-group-instance" class="anchor-navigation-ex-anchor" href="#get-group-instance"><i class="fa fa-link" aria-hidden="true"></i></a>1.6.4. Get Group Instance</h3>
<pre class="language-"><code class="lang-objective-c"><span class="token operator">+</span> <span class="token punctuation">(</span>instancetype<span class="token punctuation">)</span>meshGroupWithGroupId<span class="token punctuation">:</span><span class="token punctuation">(</span>NSInteger<span class="token punctuation">)</span>groupId<span class="token punctuation">;</span>
</code></pre>
<blockquote>
<p>Note: The <code>groupId</code> here is not the <code>localId</code> described above. This is the field given by the server after the group is successfully added.</p>
<p>All addresses issued by group operations are only related to <code>localId</code></p>
</blockquote>
<h3 id="update-group-name"><a name="update-group-name" class="anchor-navigation-ex-anchor" href="#update-group-name"><i class="fa fa-link" aria-hidden="true"></i></a>1.6.5. Update Group Name</h3>
<p><strong>Declaration</strong></p>
<pre class="language-"><code class="lang-objective-c"><span class="token operator">-</span> <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>updateMeshGroupName<span class="token punctuation">:</span><span class="token punctuation">(</span>NSString <span class="token operator">*</span><span class="token punctuation">)</span>meshGroupName success<span class="token punctuation">:</span><span class="token punctuation">(</span>TYSuccessHandler<span class="token punctuation">)</span>success failure<span class="token punctuation">:</span><span class="token punctuation">(</span>TYFailureError<span class="token punctuation">)</span>failure<span class="token punctuation">;</span>
</code></pre>
<p><strong>Parameters</strong></p>
<table>
<thead>
<tr>
<th>parameter</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>meshGroupName</td>
<td>new name</td>
</tr>
<tr>
<td>success</td>
<td>success block</td>
</tr>
<tr>
<td>failure</td>
<td>failure block</td>
</tr>
</tbody>
</table>
<h3 id="remove-device-from-group_1"><a name="remove-device-from-group_1" class="anchor-navigation-ex-anchor" href="#remove-device-from-group_1"><i class="fa fa-link" aria-hidden="true"></i></a>1.6.6. Remove Device From Group</h3>
<p><strong>Declaration</strong></p>
<pre class="language-"><code class="lang-objective-c"><span class="token comment">// Bluetooth</span>
<span class="token operator">-</span> <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>deleteGroupAddress<span class="token punctuation">:</span><span class="token punctuation">(</span>uint32_t<span class="token punctuation">)</span>groupAddress type<span class="token punctuation">:</span><span class="token punctuation">(</span>NSString <span class="token operator">*</span><span class="token punctuation">)</span>type<span class="token punctuation">;</span>

<span class="token comment">// Gateway</span>
<span class="token operator">-</span> <span class="token punctuation">(</span>NSString <span class="token operator">*</span><span class="token punctuation">)</span>rawDataDeleteGroupAddress<span class="token punctuation">:</span><span class="token punctuation">(</span>uint32_t<span class="token punctuation">)</span>groupAddress type<span class="token punctuation">:</span><span class="token punctuation">(</span>NSString <span class="token operator">*</span><span class="token punctuation">)</span>type

<span class="token operator">-</span> <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>publishRawDataWithRaw<span class="token punctuation">:</span><span class="token punctuation">(</span>NSString <span class="token operator">*</span><span class="token punctuation">)</span>raw
       pcc<span class="token punctuation">:</span><span class="token punctuation">(</span>NSString <span class="token operator">*</span><span class="token punctuation">)</span>pcc
                      success<span class="token punctuation">:</span><span class="token punctuation">(</span>TYSuccessHandler<span class="token punctuation">)</span>success
                      failure<span class="token punctuation">:</span><span class="token punctuation">(</span>TYFailureError<span class="token punctuation">)</span>failure<span class="token punctuation">;</span>
</code></pre>
<p>Remote delete</p>
<p><strong>Declaration</strong></p>
<pre class="language-"><code class="lang-objective-c"><span class="token operator">-</span> <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>removeMeshGroupWithSuccess<span class="token punctuation">:</span><span class="token punctuation">(</span>TYSuccessHandler<span class="token punctuation">)</span>success failure<span class="token punctuation">:</span><span class="token punctuation">(</span>TYFailureError<span class="token punctuation">)</span>failure<span class="token punctuation">;</span>
</code></pre>
<p><strong>Parameters</strong></p>
<table>
<thead>
<tr>
<th>parameter</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>success</td>
<td>success block</td>
</tr>
<tr>
<td>failure</td>
<td>failure block</td>
</tr>
</tbody>
</table>
<p><strong>Example</strong></p>
<pre class="language-"><code class="lang-objective-c">
    <span class="token punctuation">[</span><span class="token keyword">self</span><span class="token punctuation">.</span>meshGroup removeMeshGroupWithSuccess<span class="token punctuation">:</span><span class="token operator">^</span><span class="token punctuation">{</span>
           <span class="token comment">//</span>
    <span class="token punctuation">}</span> failure<span class="token punctuation">:</span><span class="token operator">^</span><span class="token punctuation">(</span>NSError <span class="token operator">*</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// </span>
    <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token comment">// if local connection</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">[</span>TYBLEMeshManager sharedInstance<span class="token punctuation">]</span><span class="token punctuation">.</span>isLogin<span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token comment">// use ble </span>
        <span class="token punctuation">[</span><span class="token punctuation">[</span>TYBLEMeshManager sharedInstance<span class="token punctuation">]</span> deleteGroupAddress<span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token keyword">self</span><span class="token punctuation">.</span>meshGroup<span class="token punctuation">.</span>meshGroupModel<span class="token punctuation">.</span>localId intValue<span class="token punctuation">]</span> type<span class="token punctuation">:</span><span class="token keyword">self</span><span class="token punctuation">.</span>meshGroup<span class="token punctuation">.</span>meshGroupModel<span class="token punctuation">.</span>pcc<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token comment">// Wi-Fi</span>
        <span class="token comment">// use gateway</span>
        <span class="token punctuation">[</span><span class="token punctuation">[</span>TuyaSmartUser sharedInstance<span class="token punctuation">]</span><span class="token punctuation">.</span>mesh publishRawDataWithRaw<span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token punctuation">[</span>TYBLEMeshManager sharedInstance<span class="token punctuation">]</span> rawDataDeleteGroupAddress<span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token keyword">self</span><span class="token punctuation">.</span>meshGroup<span class="token punctuation">.</span>meshGroupModel<span class="token punctuation">.</span>localId intValue<span class="token punctuation">]</span> type<span class="token punctuation">:</span><span class="token keyword">self</span><span class="token punctuation">.</span>meshGroup<span class="token punctuation">.</span>meshGroupModel<span class="token punctuation">.</span>pcc<span class="token punctuation">]</span> pcc<span class="token punctuation">:</span><span class="token keyword">self</span><span class="token punctuation">.</span>meshGroup<span class="token punctuation">.</span>meshGroupModel<span class="token punctuation">.</span>pcc success<span class="token punctuation">:</span><span class="token operator">^</span><span class="token punctuation">{</span>
        <span class="token punctuation">}</span> failure<span class="token punctuation">:</span><span class="token operator">^</span><span class="token punctuation">(</span>NSError <span class="token operator">*</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre>
<h3 id="get-devices-from-group"><a name="get-devices-from-group" class="anchor-navigation-ex-anchor" href="#get-devices-from-group"><i class="fa fa-link" aria-hidden="true"></i></a>1.6.7. Get Devices From Group</h3>
<p><strong>Declaration</strong></p>
<pre class="language-"><code class="lang-objective-c"><span class="token operator">-</span> <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>getDeviveListInfoWithSuccess<span class="token punctuation">:</span><span class="token punctuation">(</span><span class="token keyword">void</span> <span class="token punctuation">(</span><span class="token operator">^</span><span class="token punctuation">)</span><span class="token punctuation">(</span>NSArray <span class="token operator">&lt;</span>TuyaSmartDeviceModel <span class="token operator">*</span><span class="token operator">&gt;</span> <span class="token operator">*</span>deviceList<span class="token punctuation">)</span><span class="token punctuation">)</span>success failure<span class="token punctuation">:</span><span class="token punctuation">(</span>TYFailureError<span class="token punctuation">)</span>failure<span class="token punctuation">;</span>
</code></pre>
<p><strong>Parameters</strong></p>
<table>
<thead>
<tr>
<th>parameter</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>success</td>
<td>success block</td>
</tr>
<tr>
<td>failure</td>
<td>failure block</td>
</tr>
</tbody>
</table>
<p><strong>Example</strong></p>
<pre class="language-"><code class="lang-objective-c"><span class="token punctuation">[</span><span class="token keyword">self</span><span class="token punctuation">.</span>meshGroup getDeviveListInfoWithSuccess<span class="token punctuation">:</span><span class="token operator">^</span><span class="token punctuation">(</span>NSArray<span class="token operator">&lt;</span>TuyaSmartDeviceModel <span class="token operator">*</span><span class="token operator">&gt;</span> <span class="token operator">*</span>deviceList<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// success</span>
<span class="token punctuation">}</span> failure<span class="token punctuation">:</span><span class="token operator">^</span><span class="token punctuation">(</span>NSError <span class="token operator">*</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// fail</span>
        <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre>
<h2 id="control"><a name="control" class="anchor-navigation-ex-anchor" href="#control"><i class="fa fa-link" aria-hidden="true"></i></a>1.7. Control</h2>
<h4 id="command"><a name="command" class="anchor-navigation-ex-anchor" href="#command"><i class="fa fa-link" aria-hidden="true"></i></a><a name="command" class="plugin-anchor" href="#command"><i class="fa fa-link" aria-hidden="true"></i></a>Command</h4>
<p><code>{&quot;(dpId)&quot; : &quot;(dpValue)&quot;}</code>&#xFF0C;  <code>@{@&quot;101&quot; : @&quot;44&quot;}</code></p>
<h3 id="control-command---control-devices"><a name="control-command---control-devices" class="anchor-navigation-ex-anchor" href="#control-command---control-devices"><i class="fa fa-link" aria-hidden="true"></i></a>1.7.1. Control Command - Control Devices</h3>
<p><strong>Declaration</strong></p>
<pre class="language-"><code class="lang-objective-c"><span class="token operator">-</span> <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>publishNodeId<span class="token punctuation">:</span><span class="token punctuation">(</span>NSString <span class="token operator">*</span><span class="token punctuation">)</span>nodeId
                  pcc<span class="token punctuation">:</span><span class="token punctuation">(</span>NSString <span class="token operator">*</span><span class="token punctuation">)</span>pcc
                  dps<span class="token punctuation">:</span><span class="token punctuation">(</span>NSDictionary <span class="token operator">*</span><span class="token punctuation">)</span>dps
              success<span class="token punctuation">:</span><span class="token punctuation">(</span>TYSuccessHandler<span class="token punctuation">)</span>success
              failure<span class="token punctuation">:</span><span class="token punctuation">(</span>TYFailureError<span class="token punctuation">)</span>failure<span class="token punctuation">;</span>
</code></pre>
<p><strong>Parameters</strong></p>
<table>
<thead>
<tr>
<th>parameter</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>nodeId</td>
<td>device node</td>
</tr>
<tr>
<td>pcc</td>
<td>pcc</td>
</tr>
<tr>
<td>dps</td>
<td>dps dictionary</td>
</tr>
<tr>
<td>success</td>
<td>success block</td>
</tr>
<tr>
<td>failure</td>
<td>failure block</td>
</tr>
</tbody>
</table>
<p><strong>Example</strong></p>
<pre class="language-"><code class="lang-objective-c"><span class="token keyword">int</span> address <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token keyword">self</span><span class="token punctuation">.</span>smartDevice deviceModel<span class="token punctuation">]</span><span class="token punctuation">.</span>nodeId intValue<span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token number">8</span><span class="token punctuation">;</span>

<span class="token punctuation">[</span><span class="token keyword">self</span><span class="token punctuation">.</span>mesh publishNodeId<span class="token punctuation">:</span><span class="token punctuation">[</span>NSString stringWithFormat<span class="token punctuation">:</span><span class="token string">@&quot;%d&quot;</span><span class="token punctuation">,</span> address<span class="token punctuation">]</span> pcc<span class="token punctuation">:</span><span class="token keyword">self</span><span class="token punctuation">.</span>smartDevice<span class="token punctuation">.</span>deviceModel<span class="token punctuation">.</span>pcc dps<span class="token punctuation">:</span><span class="token operator">@</span><span class="token punctuation">{</span><span class="token string">@&quot;1&quot;</span><span class="token punctuation">:</span><span class="token operator">@</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">}</span> success<span class="token punctuation">:</span><span class="token operator">^</span><span class="token punctuation">{</span>
    <span class="token comment">// success do </span>
    <span class="token punctuation">}</span> failure<span class="token punctuation">:</span><span class="token operator">^</span><span class="token punctuation">(</span>NSError <span class="token operator">*</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// error do</span>
<span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre>
<h3 id="control-command---control-group"><a name="control-command---control-group" class="anchor-navigation-ex-anchor" href="#control-command---control-group"><i class="fa fa-link" aria-hidden="true"></i></a>1.7.2. Control Command - Control Group</h3>
<p><strong>Declaration</strong></p>
<pre class="language-"><code class="lang-objective-c"><span class="token operator">-</span> <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>multiPublishWithLocalId<span class="token punctuation">:</span><span class="token punctuation">(</span>NSString <span class="token operator">*</span><span class="token punctuation">)</span>localId
                            pcc<span class="token punctuation">:</span><span class="token punctuation">(</span>NSString <span class="token operator">*</span><span class="token punctuation">)</span>pcc
                            dps<span class="token punctuation">:</span><span class="token punctuation">(</span>NSDictionary <span class="token operator">*</span><span class="token punctuation">)</span>dps
                        success<span class="token punctuation">:</span><span class="token punctuation">(</span>TYSuccessHandler<span class="token punctuation">)</span>success
                        failure<span class="token punctuation">:</span><span class="token punctuation">(</span>TYFailureError<span class="token punctuation">)</span>failure<span class="token punctuation">;</span>
</code></pre>
<p><strong>Example</strong></p>
<pre class="language-"><code class="lang-objective-c"><span class="token keyword">int</span> address <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token keyword">self</span><span class="token punctuation">.</span>meshGroup meshGroupModel<span class="token punctuation">]</span><span class="token punctuation">.</span>localId intValue<span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token punctuation">[</span><span class="token keyword">self</span><span class="token punctuation">.</span>mesh multiPublishWithLocalId<span class="token punctuation">:</span><span class="token punctuation">[</span>NSString stringWithFormat<span class="token punctuation">:</span><span class="token string">@&quot;%d&quot;</span><span class="token punctuation">,</span> address<span class="token punctuation">]</span> pcc<span class="token punctuation">:</span><span class="token keyword">self</span><span class="token punctuation">.</span>meshGroup<span class="token punctuation">.</span>meshGroupModel<span class="token punctuation">.</span>pcc dps<span class="token punctuation">:</span><span class="token operator">@</span><span class="token punctuation">{</span><span class="token string">@&quot;1&quot;</span><span class="token punctuation">:</span><span class="token operator">@</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">}</span> success<span class="token punctuation">:</span><span class="token operator">^</span><span class="token punctuation">{</span>
    <span class="token comment">// success do </span>
    <span class="token punctuation">}</span> failure<span class="token punctuation">:</span><span class="token operator">^</span><span class="token punctuation">(</span>NSError <span class="token operator">*</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// error do</span>
<span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre>
<h4 id="gateway-raw-command"><a name="gateway-raw-command" class="anchor-navigation-ex-anchor" href="#gateway-raw-command"><i class="fa fa-link" aria-hidden="true"></i></a><a name="gateway-raw-command" class="plugin-anchor" href="#gateway-raw-command"><i class="fa fa-link" aria-hidden="true"></i></a>Gateway Raw Command</h4>
<blockquote>
<p>TYBLEMeshManager support raw command</p>
</blockquote>
<p><strong>Declaration</strong></p>
<pre class="language-"><code class="lang-objective-c"><span class="token operator">-</span> <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>publishRawDataWithRaw<span class="token punctuation">:</span><span class="token punctuation">(</span>NSString <span class="token operator">*</span><span class="token punctuation">)</span>raw
                          pcc<span class="token punctuation">:</span><span class="token punctuation">(</span>NSString <span class="token operator">*</span><span class="token punctuation">)</span>pcc
                      success<span class="token punctuation">:</span><span class="token punctuation">(</span>TYSuccessHandler<span class="token punctuation">)</span>success
                      failure<span class="token punctuation">:</span><span class="token punctuation">(</span>TYFailureError<span class="token punctuation">)</span>failure<span class="token punctuation">;</span>
</code></pre>
<h4 id="device-info-update"><a name="device-info-update" class="anchor-navigation-ex-anchor" href="#device-info-update"><i class="fa fa-link" aria-hidden="true"></i></a><a name="device-info-update" class="plugin-anchor" href="#device-info-update"><i class="fa fa-link" aria-hidden="true"></i></a>Device Info Update</h4>
<p>After sending the command, if there is a returned command, the device&apos;s data reply is called back through the proxy in <code>TuyaSmartHomeDelegate</code></p>
<p><strong>Declaration</strong></p>
<pre class="language-"><code class="lang-objective-c"><span class="token comment">// dps update</span>
<span class="token operator">-</span> <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>home<span class="token punctuation">:</span><span class="token punctuation">(</span>TuyaSmartHome <span class="token operator">*</span><span class="token punctuation">)</span>home device<span class="token punctuation">:</span><span class="token punctuation">(</span>TuyaSmartDeviceModel <span class="token operator">*</span><span class="token punctuation">)</span>device dpsUpdate<span class="token punctuation">:</span><span class="token punctuation">(</span>NSDictionary <span class="token operator">*</span><span class="token punctuation">)</span>dps<span class="token punctuation">;</span>
</code></pre>
<h2 id="firmware-upgrade"><a name="firmware-upgrade" class="anchor-navigation-ex-anchor" href="#firmware-upgrade"><i class="fa fa-link" aria-hidden="true"></i></a>1.8. Firmware Upgrade</h2>
<h3 id="query-firmware-info"><a name="query-firmware-info" class="anchor-navigation-ex-anchor" href="#query-firmware-info"><i class="fa fa-link" aria-hidden="true"></i></a>1.8.1. Query Firmware Info</h3>
<p><strong>Declaration</strong></p>
<p>get device upgrade info</p>
<pre class="language-"><code class="lang-objective-c"><span class="token comment">/**
 *  get device upgrade info
 *
 *  @param success
 *  @param failure 
 */</span>
<span class="token operator">-</span> <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>getFirmwareUpgradeInfo<span class="token punctuation">:</span><span class="token punctuation">(</span><span class="token keyword">void</span> <span class="token punctuation">(</span><span class="token operator">^</span><span class="token punctuation">)</span><span class="token punctuation">(</span>NSArray <span class="token operator">&lt;</span>TuyaSmartFirmwareUpgradeModel <span class="token operator">*</span><span class="token operator">&gt;</span> <span class="token operator">*</span>upgradeModelList<span class="token punctuation">)</span><span class="token punctuation">)</span>success failure<span class="token punctuation">:</span><span class="token punctuation">(</span>TYFailureError<span class="token punctuation">)</span>failure<span class="token punctuation">;</span>

<span class="token comment">/*
type 
     0  updrading
     1  no upgrade
     2  force or remind upgrade
     3  check upgrade
*/</span>
</code></pre>
<p><strong>Parameters</strong></p>
<table>
<thead>
<tr>
<th>parameter</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>success</td>
<td>success block</td>
</tr>
<tr>
<td>failure</td>
<td>failure block</td>
</tr>
</tbody>
</table>
<h3 id="sub-device-upgrade"><a name="sub-device-upgrade" class="anchor-navigation-ex-anchor" href="#sub-device-upgrade"><i class="fa fa-link" aria-hidden="true"></i></a>1.8.2. Sub-Device Upgrade</h3>
<p>Ensure device online</p>
<p><strong>connect target device</strong></p>
<p><strong>Declaration</strong></p>
<pre class="language-"><code class="lang-objective-c"><span class="token operator">-</span> <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>startScanWithName<span class="token punctuation">:</span><span class="token punctuation">(</span>NSString <span class="token operator">*</span><span class="token punctuation">)</span>name
                      pwd<span class="token punctuation">:</span><span class="token punctuation">(</span>NSString <span class="token operator">*</span><span class="token punctuation">)</span>pwd
                   active<span class="token punctuation">:</span><span class="token punctuation">(</span>BOOL<span class="token punctuation">)</span>active
              wifiAddress<span class="token punctuation">:</span><span class="token punctuation">(</span>uint32_t<span class="token punctuation">)</span>wifiAddress
               otaAddress<span class="token punctuation">:</span><span class="token punctuation">(</span>uint32_t<span class="token punctuation">)</span>otaAddress<span class="token punctuation">;</span>
</code></pre>
<p><strong>After setting, it will be connected. You can receive the connection through the <code>TYBLEMeshManagerDelegate</code> proxy method</strong></p>
<p><strong>Declaration</strong></p>
<pre class="language-"><code class="lang-objective-c"><span class="token operator">-</span> <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>notifyLoginSuccessWithAddress<span class="token punctuation">:</span><span class="token punctuation">(</span>uint32_t<span class="token punctuation">)</span>address<span class="token punctuation">;</span>
</code></pre>
<p><strong>Parameters</strong></p>
<table>
<thead>
<tr>
<th>parameter</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>address</td>
<td>node address</td>
</tr>
</tbody>
</table>
<p><strong>Send upgrade package after receiving callback</strong></p>
<pre class="language-"><code>- (void)sendOTAPackWithAddress:(NSInteger)address version:(NSString *)version otaData:(NSData *)otaData success:(TYSuccessHandler)success failure:(TYFailureHandler)failure;
</code></pre><p><strong>Update version number to the remote</strong></p>
<p><strong>Declaration</strong></p>
<pre class="language-"><code class="lang-objective-c"><span class="token operator">-</span> <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>updateDeviceVersion<span class="token punctuation">:</span><span class="token punctuation">(</span>NSString <span class="token operator">*</span><span class="token punctuation">)</span>version type<span class="token punctuation">:</span><span class="token punctuation">(</span>NSInteger<span class="token punctuation">)</span>type success<span class="token punctuation">:</span><span class="token punctuation">(</span>TYSuccessHandler<span class="token punctuation">)</span>success failure<span class="token punctuation">:</span><span class="token punctuation">(</span>TYFailureError<span class="token punctuation">)</span>failure<span class="token punctuation">;</span>
</code></pre>
<p><strong>Parameters</strong></p>
<table>
<thead>
<tr>
<th>parameter</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>version</td>
<td>version</td>
</tr>
<tr>
<td>type</td>
<td>upgradeModel.type</td>
</tr>
<tr>
<td>success</td>
<td>success block</td>
</tr>
<tr>
<td>failure</td>
<td>failure block</td>
</tr>
</tbody>
</table>
<p><strong>Example</strong></p>
<pre class="language-"><code class="lang-objective-c"><span class="token number">1.</span> prepare
<span class="token keyword">int</span> otaAddress <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token keyword">self</span><span class="token punctuation">.</span>device<span class="token punctuation">.</span>deviceModel<span class="token punctuation">.</span>nodeId intValue<span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token number">8</span><span class="token punctuation">;</span>
<span class="token comment">// ble connect</span>
    <span class="token punctuation">[</span><span class="token punctuation">[</span>TYBLEMeshManager sharedInstance<span class="token punctuation">]</span> startScanWithName<span class="token punctuation">:</span><span class="token punctuation">[</span>TuyaSmartUser sharedInstance<span class="token punctuation">]</span><span class="token punctuation">.</span>meshModel<span class="token punctuation">.</span>code pwd<span class="token punctuation">:</span><span class="token punctuation">[</span>TuyaSmartUser sharedInstance<span class="token punctuation">]</span><span class="token punctuation">.</span>meshModel<span class="token punctuation">.</span>password active<span class="token punctuation">:</span>NO wifiAddress<span class="token punctuation">:</span><span class="token number">0</span> otaAddress<span class="token punctuation">:</span>otaAddress<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">[</span>TYBLEMeshManager sharedInstance<span class="token punctuation">]</span><span class="token punctuation">.</span>delegate <span class="token operator">=</span> <span class="token keyword">self</span><span class="token punctuation">;</span>


<span class="token number">2.</span> <span class="token number">3.</span> callback and send pack
<span class="token operator">-</span> <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>notifyLoginSuccessWithAddress<span class="token punctuation">:</span><span class="token punctuation">(</span>uint32_t<span class="token punctuation">)</span>address <span class="token punctuation">{</span>
    <span class="token punctuation">[</span><span class="token punctuation">[</span>TYBLEMeshManager sharedInstance<span class="token punctuation">]</span> sendOTAPackWithAddress<span class="token punctuation">:</span>address version<span class="token punctuation">:</span>#<span class="token operator">&lt;</span>version<span class="token operator">&gt;</span> otaData<span class="token punctuation">:</span>_otaData success<span class="token punctuation">:</span><span class="token operator">^</span><span class="token punctuation">{</span>
        <span class="token punctuation">[</span><span class="token keyword">self</span> updateVersion<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> failure<span class="token punctuation">:</span><span class="token operator">^</span><span class="token punctuation">{</span>
        <span class="token function">NSLog</span><span class="token punctuation">(</span><span class="token string">@&quot;ota failure!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token number">4.</span> Update version
<span class="token operator">-</span> <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>updateVersion <span class="token punctuation">{</span>
    WEAKSELF_AT
    <span class="token punctuation">[</span><span class="token keyword">self</span><span class="token punctuation">.</span>smartDevice updateDeviceVersion<span class="token punctuation">:</span>_upgradeModel<span class="token punctuation">.</span>version type<span class="token punctuation">:</span>_upgradeModel<span class="token punctuation">.</span>type success<span class="token punctuation">:</span><span class="token operator">^</span><span class="token punctuation">{</span>
       <span class="token comment">// success do..</span>
    <span class="token punctuation">}</span> failure<span class="token punctuation">:</span><span class="token operator">^</span><span class="token punctuation">(</span>NSError <span class="token operator">*</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
       <span class="token comment">// error do.. </span>
    <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="SIGMesh.html#firmware-upgrade" class="navigation navigation-prev " aria-label="Previous page: Firmware Upgrade">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="Mesh.html#prepare" class="navigation navigation-next " aria-label="Next page: Prepare">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Bluetooth Mesh(TUYA)","level":"2.1.3","depth":2,"next":{"title":"Prepare","level":"2.1.3.1","depth":3,"anchor":"#prepare","path":"resource/Mesh.md","ref":"./resource/Mesh.md#prepare","articles":[]},"previous":{"title":"Firmware Upgrade","level":"2.1.2.8","depth":3,"anchor":"#firmware-upgrade","path":"resource/SIGMesh.md","ref":"./resource/SIGMesh.md#firmware-upgrade","articles":[]},"dir":"ltr"},"config":{"plugins":["js-sequence-diagram-full@>=0.3.1","prism","-highlight","anchors","splitter","github","anchor-navigation-ex","ga","expandable-chapters-small","pageview-count","language-picker","hide-element","flexible-alerts"],"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"pluginsConfig":{"prism":{"css":["prismjs/themes/prism-okaidia.css"],"lang":{"oc":"objectivec","objc":"objectivec","objective-c":"objectivec"},"ignore":["sequence"]},"language-picker":{"grid-columns":3},"github":{"url":"https://github.com/TuyaInc/tuyasmart_home_ios_sdk"},"splitter":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"js-sequence-diagram-full":{},"hide-element":{"elements":[".gitbook-link"]},"fontsettings":{"theme":"white","family":"sans","size":2},"anchor-navigation-ex":{"associatedWithSummary":true,"float":{"floatIcon":"fa fa-navicon","level1Icon":"","level2Icon":"","level3Icon":"","showLevelIcon":false},"mode":"float","multipleH1":true,"pageTop":{"level1Icon":"","level2Icon":"","level3Icon":"","showLevelIcon":false},"printLog":false,"showGoTop":false,"showLevel":true},"pageview-count":{},"expandable-chapters-small":{},"flexible-alerts":{"danger":{"className":"danger","icon":"fa fa-ban","label":{"zh-hans":"æ³¨æ","en":"Attention"}},"note":{"className":"info","icon":"fa fa-info-circle","label":{"zh-hans":"æç¤º","en":"Note"}},"style":"flat","tip":{"className":"tip","icon":"fa fa-lightbulb-o","label":{"zh-hans":"Tips","en":"Tip"}},"warning":{"className":"warning","icon":"fa fa-exclamation-triangle","label":{"zh-hans":"è­¦å","en":"Warning"}}},"ga":{"configuration":"auto","token":"UA-165828612-1"},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false},"anchors":{}},"theme":"default","pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{},"language":"en","gitbook":"*"},"file":{"path":"resource/Mesh.md","mtime":"2021-01-09T03:40:24.981Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2021-01-09T03:41:24.778Z"},"basePath":"..","book":{"language":"en"}});
        });
    </script>
</div>

        
    <script src="../../gitbook/gitbook.js"></script>
    <script src="../../gitbook/theme.js"></script>
    
        
        <script src="../../gitbook/gitbook-plugin-js-sequence-diagram-full/sequence-diagram-min.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-js-sequence-diagram-full/plugin.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-splitter/splitter.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-github/plugin.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-ga/plugin.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-expandable-chapters-small/expandable-chapters-small.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-pageview-count/plugin.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-language-picker/plugin.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-hide-element/plugin.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-flexible-alerts/plugin.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

